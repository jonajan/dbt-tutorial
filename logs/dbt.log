2020-09-09 08:41:23.021838 (MainThread): Running with dbt=0.18.0
2020-09-09 08:41:23.047844 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 08:41:23.949255 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-09-09 08:41:23.956257 (MainThread): Tracking: tracking
2020-09-09 08:41:23.956257 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7D0692E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7E38C940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7E38CCD0>]}
2020-09-09 08:41:23.977283 (MainThread): Partial parsing not enabled
2020-09-09 08:41:23.980271 (MainThread): Parsing macros\adapters.sql
2020-09-09 08:41:23.997270 (MainThread): Parsing macros\catalog.sql
2020-09-09 08:41:24.002273 (MainThread): Parsing macros\etc.sql
2020-09-09 08:41:24.004578 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 08:41:24.010601 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 08:41:24.022592 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 08:41:24.025605 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 08:41:24.028593 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 08:41:24.038588 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 08:41:24.047911 (MainThread): Parsing macros\core.sql
2020-09-09 08:41:24.052353 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 08:41:24.088378 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 08:41:24.097399 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 08:41:24.099513 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 08:41:24.102072 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 08:41:24.104089 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 08:41:24.107090 (MainThread): Parsing macros\etc\query.sql
2020-09-09 08:41:24.109332 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 08:41:24.117600 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 08:41:24.130353 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 08:41:24.133234 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 08:41:24.139296 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 08:41:24.158317 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 08:41:24.181743 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 08:41:24.183745 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 08:41:24.199969 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 08:41:24.206888 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 08:41:24.212426 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 08:41:24.219052 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 08:41:24.222054 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 08:41:24.224055 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 08:41:24.227057 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 08:41:24.234072 (MainThread): Partial parsing not enabled
2020-09-09 08:41:24.272080 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-09-09 08:41:24.296085 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-09-09 08:41:24.504125 (MainThread): Found 2 models, 4 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 08:41:24.505127 (MainThread): 
2020-09-09 08:41:24.506119 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 08:41:24.509123 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial-289007".
2020-09-09 08:41:24.509123 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-09 08:41:24.835601 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_dbttutorial-289007_dbt_jonathan".
2020-09-09 08:41:24.835601 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "create_dbttutorial-289007_dbt_jonathan".
2020-09-09 08:41:24.835601 (ThreadPoolExecutor-0_0): Creating schema "dbttutorial-289007.dbt_jonathan".
2020-09-09 08:41:24.835601 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state closed
2020-09-09 08:41:24.836603 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 08:41:25.411054 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 08:41:25.411054 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 08:41:25.412021 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 08:41:25.731651 (MainThread): 10:41:25 | Concurrency: 1 threads (target='dev')
2020-09-09 08:41:25.732658 (MainThread): 10:41:25 | 
2020-09-09 08:41:25.743654 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-09-09 08:41:25.745646 (Thread-1): 10:41:25 | 1 of 2 START table model dbt_jonathan.my_first_dbt_model............. [RUN]
2020-09-09 08:41:25.745646 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-09-09 08:41:25.745646 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-09-09 08:41:25.760664 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-09-09 08:41:25.762652 (Thread-1): finished collecting timing info
2020-09-09 08:41:25.797659 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-09-09 08:41:25.798659 (Thread-1): Opening a new connection, currently in state init
2020-09-09 08:41:25.799670 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial-289007`.`dbt_jonathan`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-09-09 08:41:28.213054 (Thread-1): finished collecting timing info
2020-09-09 08:41:28.214348 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcb0c04-7f47-4539-943d-3f72e0e4d30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7E6193D0>]}
2020-09-09 08:41:28.215060 (Thread-1): 10:41:28 | 1 of 2 OK created table model dbt_jonathan.my_first_dbt_model........ [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.47s]
2020-09-09 08:41:28.216050 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-09-09 08:41:28.216050 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-09-09 08:41:28.218055 (Thread-1): 10:41:28 | 2 of 2 START view model dbt_jonathan.my_second_dbt_model............. [RUN]
2020-09-09 08:41:28.218055 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-09-09 08:41:28.218055 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-09-09 08:41:28.225062 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-09-09 08:41:28.226050 (Thread-1): finished collecting timing info
2020-09-09 08:41:28.243054 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-09-09 08:41:28.244066 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 08:41:28.244066 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbttutorial-289007`.`dbt_jonathan`.`my_first_dbt_model`
where id = 1;


2020-09-09 08:41:29.078568 (Thread-1): finished collecting timing info
2020-09-09 08:41:29.079569 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8bcb0c04-7f47-4539-943d-3f72e0e4d30c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7E6C3A00>]}
2020-09-09 08:41:29.080560 (Thread-1): 10:41:29 | 2 of 2 OK created view model dbt_jonathan.my_second_dbt_model........ [CREATE VIEW in 0.86s]
2020-09-09 08:41:29.080560 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-09-09 08:41:29.082568 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 08:41:29.082568 (MainThread): 10:41:29 | 
2020-09-09 08:41:29.082568 (MainThread): 10:41:29 | Finished running 1 table model, 1 view model in 4.58s.
2020-09-09 08:41:29.083552 (MainThread): Connection 'master' was properly closed.
2020-09-09 08:41:29.083552 (MainThread): Connection 'create_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 08:41:29.083552 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 08:41:29.083552 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-09-09 08:41:29.088568 (MainThread): 
2020-09-09 08:41:29.088568 (MainThread): Completed successfully
2020-09-09 08:41:29.090558 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-09-09 08:41:29.091554 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7E6D9C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7E6D9A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001BA7E6D9F40>]}
2020-09-09 08:41:29.091554 (MainThread): Flushing usage events
2020-09-09 09:12:08.533429 (MainThread): Running with dbt=0.18.0
2020-09-09 09:12:08.563421 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 09:12:09.529078 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-09-09 09:12:09.529078 (MainThread): Tracking: tracking
2020-09-09 09:12:09.530078 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB3AA2B220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB3BD4C790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB3BD4CBE0>]}
2020-09-09 09:12:09.555240 (MainThread): Partial parsing not enabled
2020-09-09 09:12:09.558258 (MainThread): Parsing macros\adapters.sql
2020-09-09 09:12:09.576309 (MainThread): Parsing macros\catalog.sql
2020-09-09 09:12:09.581269 (MainThread): Parsing macros\etc.sql
2020-09-09 09:12:09.584273 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 09:12:09.588375 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 09:12:09.601399 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 09:12:09.604443 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 09:12:09.608451 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 09:12:09.618756 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 09:12:09.624389 (MainThread): Parsing macros\core.sql
2020-09-09 09:12:09.629380 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 09:12:09.665185 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 09:12:09.674190 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 09:12:09.676731 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 09:12:09.678731 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 09:12:09.680724 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 09:12:09.682725 (MainThread): Parsing macros\etc\query.sql
2020-09-09 09:12:09.684521 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 09:12:09.692578 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 09:12:09.705624 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 09:12:09.708613 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 09:12:09.714624 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 09:12:09.733748 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 09:12:09.757807 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 09:12:09.759807 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 09:12:09.775914 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 09:12:09.782910 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 09:12:09.787877 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 09:12:09.794911 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 09:12:09.797905 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 09:12:09.798923 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 09:12:09.800912 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 09:12:09.810147 (MainThread): Partial parsing not enabled
2020-09-09 09:12:09.850767 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:12:09.868820 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-09-09 09:12:09.881020 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-09-09 09:12:10.085656 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 09:12:10.086644 (MainThread): 
2020-09-09 09:12:10.087639 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:12:10.091644 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial-289007".
2020-09-09 09:12:10.091644 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-09 09:12:10.444302 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 09:12:10.444302 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 09:12:10.445302 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:12:10.750893 (MainThread): 11:12:10 | Concurrency: 1 threads (target='dev')
2020-09-09 09:12:10.751883 (MainThread): 11:12:10 | 
2020-09-09 09:12:10.758731 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-09-09 09:12:10.759738 (Thread-1): 11:12:10 | 1 of 3 START table model dbt_jonathan.my_first_dbt_model............. [RUN]
2020-09-09 09:12:10.759738 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-09-09 09:12:10.760723 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-09-09 09:12:10.777630 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-09-09 09:12:10.778622 (Thread-1): finished collecting timing info
2020-09-09 09:12:10.798664 (Thread-1): Opening a new connection, currently in state init
2020-09-09 09:12:10.798664 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:12:11.131759 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-09-09 09:12:11.132751 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial-289007`.`dbt_jonathan`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-09-09 09:12:13.419659 (Thread-1): finished collecting timing info
2020-09-09 09:12:13.419659 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb35893-3c0e-4a07-9a6e-0d7085ea0358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB3C01DE80>]}
2020-09-09 09:12:13.420664 (Thread-1): 11:12:13 | 1 of 3 OK created table model dbt_jonathan.my_first_dbt_model........ [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.66s]
2020-09-09 09:12:13.422646 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-09-09 09:12:13.422646 (Thread-1): Began running node model.jaffle_shop.customers
2020-09-09 09:12:13.424654 (Thread-1): 11:12:13 | 2 of 3 START view model dbt_jonathan.customers....................... [RUN]
2020-09-09 09:12:13.424654 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:12:13.424654 (Thread-1): Compiling model.jaffle_shop.customers
2020-09-09 09:12:13.429768 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-09-09 09:12:13.429768 (Thread-1): finished collecting timing info
2020-09-09 09:12:13.449111 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-09-09 09:12:13.450095 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:12:13.450095 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-09-09 09:12:14.390828 (Thread-1): finished collecting timing info
2020-09-09 09:12:14.391821 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb35893-3c0e-4a07-9a6e-0d7085ea0358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB3BFD8040>]}
2020-09-09 09:12:14.392828 (Thread-1): 11:12:14 | 2 of 3 OK created view model dbt_jonathan.customers.................. [CREATE VIEW in 0.97s]
2020-09-09 09:12:14.392828 (Thread-1): Finished running node model.jaffle_shop.customers
2020-09-09 09:12:14.392828 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-09-09 09:12:14.393829 (Thread-1): 11:12:14 | 3 of 3 START view model dbt_jonathan.my_second_dbt_model............. [RUN]
2020-09-09 09:12:14.393829 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-09-09 09:12:14.393829 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-09-09 09:12:14.397035 (Thread-1): unclosed <socket.socket fd=2624, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51391), raddr=('216.58.208.42', 443)>
2020-09-09 09:12:14.397035 (Thread-1): unclosed <socket.socket fd=2352, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51390), raddr=('216.58.207.42', 443)>
2020-09-09 09:12:14.398041 (Thread-1): unclosed <socket.socket fd=2708, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51392), raddr=('216.58.207.42', 443)>
2020-09-09 09:12:14.398041 (Thread-1): unclosed <socket.socket fd=2716, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51393), raddr=('216.58.208.42', 443)>
2020-09-09 09:12:14.402041 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-09-09 09:12:14.407425 (Thread-1): finished collecting timing info
2020-09-09 09:12:14.413426 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-09-09 09:12:14.415715 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:12:14.415715 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbttutorial-289007`.`dbt_jonathan`.`my_first_dbt_model`
where id = 1;


2020-09-09 09:12:15.266604 (Thread-1): finished collecting timing info
2020-09-09 09:12:15.266604 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'dfb35893-3c0e-4a07-9a6e-0d7085ea0358', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB3C01DE80>]}
2020-09-09 09:12:15.267604 (Thread-1): 11:12:15 | 3 of 3 OK created view model dbt_jonathan.my_second_dbt_model........ [CREATE VIEW in 0.87s]
2020-09-09 09:12:15.268603 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-09-09 09:12:15.269611 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:12:15.270598 (MainThread): 11:12:15 | 
2020-09-09 09:12:15.270598 (MainThread): 11:12:15 | Finished running 1 table model, 2 view models in 5.18s.
2020-09-09 09:12:15.271597 (MainThread): Connection 'master' was properly closed.
2020-09-09 09:12:15.271597 (MainThread): Connection 'list_dbttutorial-289007' was properly closed.
2020-09-09 09:12:15.271597 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 09:12:15.271597 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-09-09 09:12:15.279901 (MainThread): 
2020-09-09 09:12:15.279901 (MainThread): Completed successfully
2020-09-09 09:12:15.280922 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-09-09 09:12:15.281902 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB3C06C7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB3BF14340>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001CB3BF142B0>]}
2020-09-09 09:12:15.281902 (MainThread): Flushing usage events
2020-09-09 09:21:38.054332 (MainThread): Running with dbt=0.18.0
2020-09-09 09:21:38.085926 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 09:21:39.015323 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-09-09 09:21:39.015323 (MainThread): Tracking: tracking
2020-09-09 09:21:39.016326 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C6E9AD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C81BD7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C81BDBB0>]}
2020-09-09 09:21:39.036314 (MainThread): Partial parsing not enabled
2020-09-09 09:21:39.037324 (MainThread): Parsing macros\adapters.sql
2020-09-09 09:21:39.054332 (MainThread): Parsing macros\catalog.sql
2020-09-09 09:21:39.059319 (MainThread): Parsing macros\etc.sql
2020-09-09 09:21:39.061320 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 09:21:39.066321 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 09:21:39.078324 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 09:21:39.081338 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 09:21:39.084339 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 09:21:39.093341 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 09:21:39.098342 (MainThread): Parsing macros\core.sql
2020-09-09 09:21:39.103344 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 09:21:39.138337 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 09:21:39.146338 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 09:21:39.147354 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 09:21:39.150340 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 09:21:39.152354 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 09:21:39.154348 (MainThread): Parsing macros\etc\query.sql
2020-09-09 09:21:39.156340 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 09:21:39.164357 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 09:21:39.177360 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 09:21:39.179346 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 09:21:39.185361 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 09:21:39.204352 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 09:21:39.227357 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 09:21:39.229371 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 09:21:39.245376 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 09:21:39.251376 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 09:21:39.257378 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 09:21:39.263365 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 09:21:39.266366 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 09:21:39.268376 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 09:21:39.270374 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 09:21:39.278369 (MainThread): Partial parsing not enabled
2020-09-09 09:21:39.316391 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:21:39.339396 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-09-09 09:21:39.355400 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-09-09 09:21:39.561301 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 09:21:39.562301 (MainThread): 
2020-09-09 09:21:39.562301 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:21:39.566303 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial-289007".
2020-09-09 09:21:39.567303 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-09 09:21:39.931437 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 09:21:39.931437 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 09:21:39.931437 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:21:40.238259 (MainThread): 11:21:40 | Concurrency: 1 threads (target='dev')
2020-09-09 09:21:40.238259 (MainThread): 11:21:40 | 
2020-09-09 09:21:40.244247 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-09-09 09:21:40.245247 (Thread-1): 11:21:40 | 1 of 3 START table model dbt_jonathan.my_first_dbt_model............. [RUN]
2020-09-09 09:21:40.245247 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-09-09 09:21:40.245247 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-09-09 09:21:40.261265 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-09-09 09:21:40.262266 (Thread-1): finished collecting timing info
2020-09-09 09:21:40.281255 (Thread-1): Opening a new connection, currently in state init
2020-09-09 09:21:40.282273 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:21:40.619741 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-09-09 09:21:40.620746 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial-289007`.`dbt_jonathan`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-09-09 09:21:43.123738 (Thread-1): finished collecting timing info
2020-09-09 09:21:43.124738 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b74c244-c78c-4295-bd30-d9542e093ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C84F48E0>]}
2020-09-09 09:21:43.125739 (Thread-1): 11:21:43 | 1 of 3 OK created table model dbt_jonathan.my_first_dbt_model........ [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.88s]
2020-09-09 09:21:43.126544 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-09-09 09:21:43.126544 (Thread-1): Began running node model.jaffle_shop.customers
2020-09-09 09:21:43.127548 (Thread-1): 11:21:43 | 2 of 3 START table model dbt_jonathan.customers...................... [RUN]
2020-09-09 09:21:43.127548 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:21:43.128547 (Thread-1): Compiling model.jaffle_shop.customers
2020-09-09 09:21:43.132561 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-09-09 09:21:43.132561 (Thread-1): finished collecting timing info
2020-09-09 09:21:43.136556 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:21:43.136556 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:21:43.491330 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:21:43.688382 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-09-09 09:21:43.688382 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `dbttutorial-289007`.`dbt_jonathan`.`customers`
  
  
  OPTIONS()
  as (
    with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-09-09 09:21:46.733807 (Thread-1): finished collecting timing info
2020-09-09 09:21:46.734807 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b74c244-c78c-4295-bd30-d9542e093ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C8437F40>]}
2020-09-09 09:21:46.735816 (Thread-1): 11:21:46 | 2 of 3 OK created table model dbt_jonathan.customers................. [CREATE TABLE (100.0 rows, 4.3 KB processed) in 3.61s]
2020-09-09 09:21:46.736622 (Thread-1): Finished running node model.jaffle_shop.customers
2020-09-09 09:21:46.736622 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-09-09 09:21:46.738632 (Thread-1): 11:21:46 | 3 of 3 START view model dbt_jonathan.my_second_dbt_model............. [RUN]
2020-09-09 09:21:46.738632 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-09-09 09:21:46.738632 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-09-09 09:21:46.745634 (Thread-1): unclosed <socket.socket fd=2608, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51557), raddr=('216.58.208.42', 443)>
2020-09-09 09:21:46.745634 (Thread-1): unclosed <socket.socket fd=2596, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51556), raddr=('172.217.23.170', 443)>
2020-09-09 09:21:46.745634 (Thread-1): unclosed <socket.socket fd=2672, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51558), raddr=('172.217.23.170', 443)>
2020-09-09 09:21:46.745634 (Thread-1): unclosed <socket.socket fd=2668, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51559), raddr=('216.58.208.42', 443)>
2020-09-09 09:21:46.746766 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-09-09 09:21:46.747646 (Thread-1): finished collecting timing info
2020-09-09 09:21:46.765650 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-09-09 09:21:46.765650 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:21:46.766744 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbttutorial-289007`.`dbt_jonathan`.`my_first_dbt_model`
where id = 1;


2020-09-09 09:21:47.617709 (Thread-1): finished collecting timing info
2020-09-09 09:21:47.617709 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b74c244-c78c-4295-bd30-d9542e093ec7', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C95CFE80>]}
2020-09-09 09:21:47.618711 (Thread-1): 11:21:47 | 3 of 3 OK created view model dbt_jonathan.my_second_dbt_model........ [CREATE VIEW in 0.88s]
2020-09-09 09:21:47.619697 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-09-09 09:21:47.620697 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:21:47.621711 (MainThread): 11:21:47 | 
2020-09-09 09:21:47.621711 (MainThread): 11:21:47 | Finished running 2 table models, 1 view model in 8.06s.
2020-09-09 09:21:47.621711 (MainThread): Connection 'master' was properly closed.
2020-09-09 09:21:47.622696 (MainThread): Connection 'list_dbttutorial-289007' was properly closed.
2020-09-09 09:21:47.622696 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 09:21:47.622696 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-09-09 09:21:47.629716 (MainThread): 
2020-09-09 09:21:47.630713 (MainThread): Completed successfully
2020-09-09 09:21:47.630713 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-09-09 09:21:47.631699 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C83CC0A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C8385310>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000138C8385A00>]}
2020-09-09 09:21:47.631699 (MainThread): Flushing usage events
2020-09-09 09:22:54.763583 (MainThread): Running with dbt=0.18.0
2020-09-09 09:22:54.793017 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 09:22:55.713359 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-09-09 09:22:55.714359 (MainThread): Tracking: tracking
2020-09-09 09:22:55.714359 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F91F67BC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F92099B7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F92099BBB0>]}
2020-09-09 09:22:55.734575 (MainThread): Partial parsing not enabled
2020-09-09 09:22:55.736559 (MainThread): Parsing macros\adapters.sql
2020-09-09 09:22:55.753563 (MainThread): Parsing macros\catalog.sql
2020-09-09 09:22:55.758564 (MainThread): Parsing macros\etc.sql
2020-09-09 09:22:55.760564 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 09:22:55.765580 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 09:22:55.777568 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 09:22:55.780569 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 09:22:55.782577 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 09:22:55.792572 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 09:22:55.797587 (MainThread): Parsing macros\core.sql
2020-09-09 09:22:55.801588 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 09:22:55.837581 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 09:22:55.846598 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 09:22:55.847599 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 09:22:55.849599 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 09:22:55.852600 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 09:22:55.854593 (MainThread): Parsing macros\etc\query.sql
2020-09-09 09:22:55.855601 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 09:22:55.864596 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 09:22:55.876605 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 09:22:55.879605 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 09:22:55.885767 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 09:22:55.903611 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 09:22:55.927616 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 09:22:55.929897 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 09:22:55.944620 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 09:22:55.951622 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 09:22:55.956609 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 09:22:55.963625 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 09:22:55.966625 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 09:22:55.969621 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 09:22:55.971611 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 09:22:55.978623 (MainThread): Partial parsing not enabled
2020-09-09 09:22:56.012620 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:22:56.029624 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-09-09 09:22:56.040627 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-09-09 09:22:56.240503 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 09:22:56.242506 (MainThread): 
2020-09-09 09:22:56.243505 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:22:56.246506 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial-289007".
2020-09-09 09:22:56.247506 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-09 09:22:56.552425 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 09:22:56.553411 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 09:22:56.553411 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:22:56.867782 (MainThread): 11:22:56 | Concurrency: 1 threads (target='dev')
2020-09-09 09:22:56.867782 (MainThread): 11:22:56 | 
2020-09-09 09:22:56.873784 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-09-09 09:22:56.874783 (Thread-1): 11:22:56 | 1 of 3 START table model dbt_jonathan.my_first_dbt_model............. [RUN]
2020-09-09 09:22:56.874783 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-09-09 09:22:56.874783 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-09-09 09:22:56.890828 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-09-09 09:22:56.891787 (Thread-1): finished collecting timing info
2020-09-09 09:22:56.910806 (Thread-1): Opening a new connection, currently in state init
2020-09-09 09:22:56.910806 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:22:57.231541 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-09-09 09:22:57.231541 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial-289007`.`dbt_jonathan`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-09-09 09:22:59.251429 (Thread-1): finished collecting timing info
2020-09-09 09:22:59.251429 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0789952b-b37a-48f6-b4d5-9344dcdef942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F920B5CD60>]}
2020-09-09 09:22:59.252432 (Thread-1): 11:22:59 | 1 of 3 OK created table model dbt_jonathan.my_first_dbt_model........ [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.38s]
2020-09-09 09:22:59.253430 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-09-09 09:22:59.253430 (Thread-1): Began running node model.jaffle_shop.customers
2020-09-09 09:22:59.254415 (Thread-1): 11:22:59 | 2 of 3 START view model dbt_jonathan.customers....................... [RUN]
2020-09-09 09:22:59.254415 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:22:59.255415 (Thread-1): Compiling model.jaffle_shop.customers
2020-09-09 09:22:59.259415 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-09-09 09:22:59.260416 (Thread-1): finished collecting timing info
2020-09-09 09:22:59.278420 (Thread-1): finished collecting timing info
2020-09-09 09:22:59.278420 (Thread-1): Compilation Error in model customers (models\customers.sql)
  Trying to create view `dbttutorial-289007`.`dbt_jonathan`.`customers`, but it currently exists as a table. Either drop `dbttutorial-289007`.`dbt_jonathan`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model customers (models\customers.sql)
Traceback (most recent call last):
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 980, in inner
    raise exc
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 977, in inner
    return func(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 641, in relation_wrong_type
    raise_compiler_error(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models\customers.sql)
  Trying to create view `dbttutorial-289007`.`dbt_jonathan`.`customers`, but it currently exists as a table. Either drop `dbttutorial-289007`.`dbt_jonathan`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model customers (models\customers.sql)
2020-09-09 09:22:59.293750 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0789952b-b37a-48f6-b4d5-9344dcdef942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F920C26820>]}
2020-09-09 09:22:59.294761 (Thread-1): 11:22:59 | 2 of 3 ERROR creating view model dbt_jonathan.customers.............. [ERROR in 0.04s]
2020-09-09 09:22:59.295752 (Thread-1): Finished running node model.jaffle_shop.customers
2020-09-09 09:22:59.295752 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-09-09 09:22:59.296773 (Thread-1): 11:22:59 | 3 of 3 START view model dbt_jonathan.my_second_dbt_model............. [RUN]
2020-09-09 09:22:59.297753 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-09-09 09:22:59.297753 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-09-09 09:22:59.303762 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-09-09 09:22:59.304775 (Thread-1): finished collecting timing info
2020-09-09 09:22:59.305756 (Thread-1): unclosed <socket.socket fd=2544, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51572), raddr=('216.58.208.42', 443)>
2020-09-09 09:22:59.306771 (Thread-1): unclosed <socket.socket fd=528, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51571), raddr=('172.217.23.170', 443)>
2020-09-09 09:22:59.312756 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-09-09 09:22:59.313766 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:22:59.314765 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbttutorial-289007`.`dbt_jonathan`.`my_first_dbt_model`
where id = 1;


2020-09-09 09:23:00.103804 (Thread-1): finished collecting timing info
2020-09-09 09:23:00.103804 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '0789952b-b37a-48f6-b4d5-9344dcdef942', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F920C176D0>]}
2020-09-09 09:23:00.104806 (Thread-1): 11:23:00 | 3 of 3 OK created view model dbt_jonathan.my_second_dbt_model........ [CREATE VIEW in 0.81s]
2020-09-09 09:23:00.105794 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-09-09 09:23:00.106806 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:23:00.107791 (MainThread): 11:23:00 | 
2020-09-09 09:23:00.107791 (MainThread): 11:23:00 | Finished running 1 table model, 2 view models in 3.87s.
2020-09-09 09:23:00.107791 (MainThread): Connection 'master' was properly closed.
2020-09-09 09:23:00.107791 (MainThread): Connection 'list_dbttutorial-289007' was properly closed.
2020-09-09 09:23:00.107791 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 09:23:00.107791 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-09-09 09:23:00.115793 (MainThread): 
2020-09-09 09:23:00.115793 (MainThread): Completed with 1 error and 0 warnings:
2020-09-09 09:23:00.116802 (MainThread): 
2020-09-09 09:23:00.116802 (MainThread): Compilation Error in model customers (models\customers.sql)
2020-09-09 09:23:00.117794 (MainThread):   Trying to create view `dbttutorial-289007`.`dbt_jonathan`.`customers`, but it currently exists as a table. Either drop `dbttutorial-289007`.`dbt_jonathan`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2020-09-09 09:23:00.117794 (MainThread):   
2020-09-09 09:23:00.118795 (MainThread):   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
2020-09-09 09:23:00.118795 (MainThread):   > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
2020-09-09 09:23:00.118795 (MainThread):   > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
2020-09-09 09:23:00.119794 (MainThread):   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
2020-09-09 09:23:00.119794 (MainThread):   > called by model customers (models\customers.sql)
2020-09-09 09:23:00.119794 (MainThread): 
Done. PASS=2 WARN=0 ERROR=1 SKIP=0 TOTAL=3
2020-09-09 09:23:00.120794 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F920C9EFA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F920B713A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001F920B71040>]}
2020-09-09 09:23:00.120794 (MainThread): Flushing usage events
2020-09-09 09:23:42.603152 (MainThread): Running with dbt=0.18.0
2020-09-09 09:23:42.629166 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 09:23:43.550817 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-09-09 09:23:43.551817 (MainThread): Tracking: tracking
2020-09-09 09:23:43.551817 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002562F4DCBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000256308028B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025630802B20>]}
2020-09-09 09:23:43.571821 (MainThread): Partial parsing not enabled
2020-09-09 09:23:43.573823 (MainThread): Parsing macros\adapters.sql
2020-09-09 09:23:43.590825 (MainThread): Parsing macros\catalog.sql
2020-09-09 09:23:43.595827 (MainThread): Parsing macros\etc.sql
2020-09-09 09:23:43.597822 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 09:23:43.602823 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 09:23:43.614831 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 09:23:43.617840 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 09:23:43.620001 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 09:23:43.629834 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 09:23:43.634835 (MainThread): Parsing macros\core.sql
2020-09-09 09:23:43.638836 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 09:23:43.673844 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 09:23:43.681846 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 09:23:43.683846 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 09:23:43.685847 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 09:23:43.687847 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 09:23:43.689848 (MainThread): Parsing macros\etc\query.sql
2020-09-09 09:23:43.691848 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 09:23:43.700049 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 09:23:43.711853 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 09:23:43.714845 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 09:23:43.720856 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 09:23:43.738853 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 09:23:43.762852 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 09:23:43.764852 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 09:23:43.779855 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 09:23:43.785869 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 09:23:43.791871 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 09:23:43.797859 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 09:23:43.800873 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 09:23:43.802873 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 09:23:43.804874 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 09:23:43.812875 (MainThread): Partial parsing not enabled
2020-09-09 09:23:43.845883 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:23:43.862887 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-09-09 09:23:43.873889 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-09-09 09:23:44.072928 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 09:23:44.073916 (MainThread): 
2020-09-09 09:23:44.074914 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:23:44.077914 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial-289007".
2020-09-09 09:23:44.078914 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-09 09:23:44.391832 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 09:23:44.391832 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 09:23:44.392833 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:23:44.701376 (MainThread): 11:23:44 | Concurrency: 1 threads (target='dev')
2020-09-09 09:23:44.702376 (MainThread): 11:23:44 | 
2020-09-09 09:23:44.710359 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-09-09 09:23:44.711368 (Thread-1): 11:23:44 | 1 of 3 START table model dbt_jonathan.my_first_dbt_model............. [RUN]
2020-09-09 09:23:44.712368 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-09-09 09:23:44.712368 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-09-09 09:23:44.727376 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-09-09 09:23:44.727376 (Thread-1): finished collecting timing info
2020-09-09 09:23:44.747374 (Thread-1): Opening a new connection, currently in state init
2020-09-09 09:23:44.747374 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:23:45.063356 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-09-09 09:23:45.065355 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial-289007`.`dbt_jonathan`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-09-09 09:23:47.584640 (Thread-1): finished collecting timing info
2020-09-09 09:23:47.584640 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b283bc5-7f6d-4204-b691-21f36bcb752e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025630AECC70>]}
2020-09-09 09:23:47.585622 (Thread-1): 11:23:47 | 1 of 3 OK created table model dbt_jonathan.my_first_dbt_model........ [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.87s]
2020-09-09 09:23:47.586623 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-09-09 09:23:47.586623 (Thread-1): Began running node model.jaffle_shop.customers
2020-09-09 09:23:47.587622 (Thread-1): 11:23:47 | 2 of 3 START view model dbt_jonathan.customers....................... [RUN]
2020-09-09 09:23:47.588622 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:23:47.588622 (Thread-1): Compiling model.jaffle_shop.customers
2020-09-09 09:23:47.594630 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-09-09 09:23:47.594630 (Thread-1): finished collecting timing info
2020-09-09 09:23:47.614641 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:23:47.614641 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:23:47.935717 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-09-09 09:23:47.935717 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-09-09 09:23:48.819294 (Thread-1): finished collecting timing info
2020-09-09 09:23:48.820304 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b283bc5-7f6d-4204-b691-21f36bcb752e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025630A87A30>]}
2020-09-09 09:23:48.821296 (Thread-1): 11:23:48 | 2 of 3 OK created view model dbt_jonathan.customers.................. [CREATE VIEW in 1.23s]
2020-09-09 09:23:48.822299 (Thread-1): Finished running node model.jaffle_shop.customers
2020-09-09 09:23:48.823302 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-09-09 09:23:48.824305 (Thread-1): 11:23:48 | 3 of 3 START view model dbt_jonathan.my_second_dbt_model............. [RUN]
2020-09-09 09:23:48.825298 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-09-09 09:23:48.825298 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-09-09 09:23:48.828305 (Thread-1): unclosed <socket.socket fd=2432, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51595), raddr=('216.58.208.42', 443)>
2020-09-09 09:23:48.828305 (Thread-1): unclosed <socket.socket fd=2420, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51594), raddr=('172.217.23.170', 443)>
2020-09-09 09:23:48.828305 (Thread-1): unclosed <socket.socket fd=2708, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51596), raddr=('172.217.23.170', 443)>
2020-09-09 09:23:48.829194 (Thread-1): unclosed <socket.socket fd=2720, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51597), raddr=('216.58.208.42', 443)>
2020-09-09 09:23:48.833204 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-09-09 09:23:48.834193 (Thread-1): finished collecting timing info
2020-09-09 09:23:48.838186 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-09-09 09:23:48.839188 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:23:48.840358 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbttutorial-289007`.`dbt_jonathan`.`my_first_dbt_model`
where id = 1;


2020-09-09 09:23:49.660201 (Thread-1): finished collecting timing info
2020-09-09 09:23:49.660201 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '4b283bc5-7f6d-4204-b691-21f36bcb752e', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025630AA34C0>]}
2020-09-09 09:23:49.661203 (Thread-1): 11:23:49 | 3 of 3 OK created view model dbt_jonathan.my_second_dbt_model........ [CREATE VIEW in 0.83s]
2020-09-09 09:23:49.662194 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-09-09 09:23:49.663199 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:23:49.663199 (MainThread): 11:23:49 | 
2020-09-09 09:23:49.664202 (MainThread): 11:23:49 | Finished running 1 table model, 2 view models in 5.59s.
2020-09-09 09:23:49.664202 (MainThread): Connection 'master' was properly closed.
2020-09-09 09:23:49.664202 (MainThread): Connection 'list_dbttutorial-289007' was properly closed.
2020-09-09 09:23:49.664202 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 09:23:49.664202 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-09-09 09:23:49.672196 (MainThread): 
2020-09-09 09:23:49.673197 (MainThread): Completed successfully
2020-09-09 09:23:49.674206 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-09-09 09:23:49.674206 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025630AF5FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025630B1B940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025630B1BA60>]}
2020-09-09 09:23:49.675197 (MainThread): Flushing usage events
2020-09-09 09:25:30.985172 (MainThread): Running with dbt=0.18.0
2020-09-09 09:25:31.017190 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 09:25:32.050341 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-09-09 09:25:32.051342 (MainThread): Tracking: tracking
2020-09-09 09:25:32.051342 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D39DACA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D4CFB9D0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D4CFBCD0>]}
2020-09-09 09:25:32.075121 (MainThread): Partial parsing not enabled
2020-09-09 09:25:32.077121 (MainThread): Parsing macros\adapters.sql
2020-09-09 09:25:32.095958 (MainThread): Parsing macros\catalog.sql
2020-09-09 09:25:32.100959 (MainThread): Parsing macros\etc.sql
2020-09-09 09:25:32.102960 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 09:25:32.107961 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 09:25:32.120973 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 09:25:32.125846 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 09:25:32.127849 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 09:25:32.137851 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 09:25:32.143862 (MainThread): Parsing macros\core.sql
2020-09-09 09:25:32.147862 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 09:25:32.183861 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 09:25:32.193864 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 09:25:32.195865 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 09:25:32.197864 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 09:25:32.200866 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 09:25:32.202867 (MainThread): Parsing macros\etc\query.sql
2020-09-09 09:25:32.204867 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 09:25:32.213424 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 09:25:32.226224 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 09:25:32.228231 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 09:25:32.235225 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 09:25:32.254230 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 09:25:32.277235 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 09:25:32.279243 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 09:25:32.295257 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 09:25:32.302241 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 09:25:32.308250 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 09:25:32.314250 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 09:25:32.317258 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 09:25:32.320254 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 09:25:32.324253 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 09:25:32.332263 (MainThread): Partial parsing not enabled
2020-09-09 09:25:32.367269 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:25:32.386273 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-09-09 09:25:32.397276 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-09-09 09:25:32.607381 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 09:25:32.608401 (MainThread): 
2020-09-09 09:25:32.609397 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:25:32.613383 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial-289007".
2020-09-09 09:25:32.613383 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-09 09:25:32.930492 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 09:25:32.931897 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 09:25:32.931897 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:25:33.230313 (MainThread): 11:25:33 | Concurrency: 1 threads (target='dev')
2020-09-09 09:25:33.230313 (MainThread): 11:25:33 | 
2020-09-09 09:25:33.236320 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-09-09 09:25:33.237323 (Thread-1): 11:25:33 | 1 of 3 START table model dbt_jonathan.my_first_dbt_model............. [RUN]
2020-09-09 09:25:33.237323 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-09-09 09:25:33.238316 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-09-09 09:25:33.254319 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-09-09 09:25:33.255321 (Thread-1): finished collecting timing info
2020-09-09 09:25:33.277324 (Thread-1): Opening a new connection, currently in state init
2020-09-09 09:25:33.277324 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:25:33.591280 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-09-09 09:25:33.592405 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial-289007`.`dbt_jonathan`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-09-09 09:25:36.088085 (Thread-1): finished collecting timing info
2020-09-09 09:25:36.088085 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15952346-92bb-4d44-9242-21b40c44ce9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D60ACB20>]}
2020-09-09 09:25:36.090085 (Thread-1): 11:25:36 | 1 of 3 OK created table model dbt_jonathan.my_first_dbt_model........ [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.85s]
2020-09-09 09:25:36.091096 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-09-09 09:25:36.091096 (Thread-1): Began running node model.jaffle_shop.customers
2020-09-09 09:25:36.093085 (Thread-1): 11:25:36 | 2 of 3 START view model dbt_jonathan.customers....................... [RUN]
2020-09-09 09:25:36.094094 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:25:36.094094 (Thread-1): Compiling model.jaffle_shop.customers
2020-09-09 09:25:36.099086 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-09-09 09:25:36.101102 (Thread-1): finished collecting timing info
2020-09-09 09:25:36.118492 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-09-09 09:25:36.119510 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:25:36.119510 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`customers`
  OPTIONS()
  as with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-09-09 09:25:37.086048 (Thread-1): finished collecting timing info
2020-09-09 09:25:37.087049 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15952346-92bb-4d44-9242-21b40c44ce9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D60F25B0>]}
2020-09-09 09:25:37.087049 (Thread-1): 11:25:37 | 2 of 3 OK created view model dbt_jonathan.customers.................. [CREATE VIEW in 0.99s]
2020-09-09 09:25:37.088034 (Thread-1): Finished running node model.jaffle_shop.customers
2020-09-09 09:25:37.089051 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-09-09 09:25:37.090037 (Thread-1): 11:25:37 | 3 of 3 START view model dbt_jonathan.my_second_dbt_model............. [RUN]
2020-09-09 09:25:37.091035 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-09-09 09:25:37.091035 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-09-09 09:25:37.094043 (Thread-1): unclosed <socket.socket fd=2332, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51617), raddr=('216.58.208.42', 443)>
2020-09-09 09:25:37.094043 (Thread-1): unclosed <socket.socket fd=2664, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51616), raddr=('172.217.22.10', 443)>
2020-09-09 09:25:37.094043 (Thread-1): unclosed <socket.socket fd=2380, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51618), raddr=('172.217.22.10', 443)>
2020-09-09 09:25:37.094043 (Thread-1): unclosed <socket.socket fd=2748, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51619), raddr=('216.58.208.42', 443)>
2020-09-09 09:25:37.099038 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-09-09 09:25:37.099038 (Thread-1): finished collecting timing info
2020-09-09 09:25:37.103468 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-09-09 09:25:37.105472 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:25:37.106477 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbttutorial-289007`.`dbt_jonathan`.`my_first_dbt_model`
where id = 1;


2020-09-09 09:25:37.969315 (Thread-1): finished collecting timing info
2020-09-09 09:25:37.970316 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '15952346-92bb-4d44-9242-21b40c44ce9f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D50345B0>]}
2020-09-09 09:25:37.971311 (Thread-1): 11:25:37 | 3 of 3 OK created view model dbt_jonathan.my_second_dbt_model........ [CREATE VIEW in 0.88s]
2020-09-09 09:25:37.972395 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-09-09 09:25:37.974303 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:25:37.974303 (MainThread): 11:25:37 | 
2020-09-09 09:25:37.975310 (MainThread): 11:25:37 | Finished running 1 table model, 2 view models in 5.36s.
2020-09-09 09:25:37.975310 (MainThread): Connection 'master' was properly closed.
2020-09-09 09:25:37.975310 (MainThread): Connection 'list_dbttutorial-289007' was properly closed.
2020-09-09 09:25:37.975310 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 09:25:37.976303 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-09-09 09:25:37.983305 (MainThread): 
2020-09-09 09:25:37.984305 (MainThread): Completed successfully
2020-09-09 09:25:37.984305 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-09-09 09:25:37.985305 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D4D61700>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D4F72FD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000249D4F72E80>]}
2020-09-09 09:25:37.985305 (MainThread): Flushing usage events
2020-09-09 09:25:51.931983 (MainThread): Running with dbt=0.18.0
2020-09-09 09:25:51.959981 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 09:25:52.917301 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-09-09 09:25:52.918302 (MainThread): Tracking: tracking
2020-09-09 09:25:52.918302 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B8789AA2E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B879CDC970>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B879CDCCD0>]}
2020-09-09 09:25:52.940347 (MainThread): Partial parsing not enabled
2020-09-09 09:25:52.942387 (MainThread): Parsing macros\adapters.sql
2020-09-09 09:25:52.959395 (MainThread): Parsing macros\catalog.sql
2020-09-09 09:25:52.965445 (MainThread): Parsing macros\etc.sql
2020-09-09 09:25:52.967447 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 09:25:52.972800 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 09:25:52.985768 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 09:25:52.990752 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 09:25:52.993800 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 09:25:53.002886 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 09:25:53.008875 (MainThread): Parsing macros\core.sql
2020-09-09 09:25:53.012903 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 09:25:53.047827 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 09:25:53.057881 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 09:25:53.058886 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 09:25:53.060886 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 09:25:53.062656 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 09:25:53.064659 (MainThread): Parsing macros\etc\query.sql
2020-09-09 09:25:53.066650 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 09:25:53.074937 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 09:25:53.087980 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 09:25:53.092126 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 09:25:53.098154 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 09:25:53.116388 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 09:25:53.140545 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 09:25:53.143558 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 09:25:53.158642 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 09:25:53.164775 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 09:25:53.169792 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 09:25:53.176338 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 09:25:53.179342 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 09:25:53.181342 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 09:25:53.183366 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 09:25:53.192565 (MainThread): Partial parsing not enabled
2020-09-09 09:25:53.232731 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:25:53.251309 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-09-09 09:25:53.262321 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-09-09 09:25:53.469418 (MainThread): Found 3 models, 4 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 09:25:53.469418 (MainThread): 
2020-09-09 09:25:53.470438 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:25:53.474195 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial-289007".
2020-09-09 09:25:53.475182 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-09 09:25:53.780249 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 09:25:53.780249 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 09:25:53.781250 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:25:54.075259 (MainThread): 11:25:54 | Concurrency: 1 threads (target='dev')
2020-09-09 09:25:54.076268 (MainThread): 11:25:54 | 
2020-09-09 09:25:54.082217 (Thread-1): Began running node model.jaffle_shop.my_first_dbt_model
2020-09-09 09:25:54.083207 (Thread-1): 11:25:54 | 1 of 3 START table model dbt_jonathan.my_first_dbt_model............. [RUN]
2020-09-09 09:25:54.084206 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_first_dbt_model".
2020-09-09 09:25:54.084206 (Thread-1): Compiling model.jaffle_shop.my_first_dbt_model
2020-09-09 09:25:54.100230 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-09-09 09:25:54.101223 (Thread-1): finished collecting timing info
2020-09-09 09:25:54.120252 (Thread-1): Opening a new connection, currently in state init
2020-09-09 09:25:54.120252 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:25:54.447099 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_first_dbt_model"
2020-09-09 09:25:54.448099 (Thread-1): On model.jaffle_shop.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_first_dbt_model"} */


  create or replace table `dbttutorial-289007`.`dbt_jonathan`.`my_first_dbt_model`
  
  
  OPTIONS()
  as (
    /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data

/*
    Uncomment the line below to remove records with null `id` values
*/

-- where id is not null
  );
    
2020-09-09 09:25:56.579310 (Thread-1): finished collecting timing info
2020-09-09 09:25:56.579310 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1008057d-23cb-449d-aaab-82969f33019c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B879F79070>]}
2020-09-09 09:25:56.580318 (Thread-1): 11:25:56 | 1 of 3 OK created table model dbt_jonathan.my_first_dbt_model........ [CREATE TABLE (2.0 rows, 0.0 Bytes processed) in 2.50s]
2020-09-09 09:25:56.581306 (Thread-1): Finished running node model.jaffle_shop.my_first_dbt_model
2020-09-09 09:25:56.582318 (Thread-1): Began running node model.jaffle_shop.customers
2020-09-09 09:25:56.582318 (Thread-1): 11:25:56 | 2 of 3 START table model dbt_jonathan.customers...................... [RUN]
2020-09-09 09:25:56.583312 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:25:56.583312 (Thread-1): Compiling model.jaffle_shop.customers
2020-09-09 09:25:56.589307 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-09-09 09:25:56.592315 (Thread-1): finished collecting timing info
2020-09-09 09:25:56.597315 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:25:56.597315 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:25:57.067893 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:25:57.308539 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-09-09 09:25:57.309544 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace table `dbttutorial-289007`.`dbt_jonathan`.`customers`
  
  
  OPTIONS()
  as (
    

with customers as (

    select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final
  );
    
2020-09-09 09:26:00.051353 (Thread-1): finished collecting timing info
2020-09-09 09:26:00.051353 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1008057d-23cb-449d-aaab-82969f33019c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B879F91CA0>]}
2020-09-09 09:26:00.052359 (Thread-1): 11:26:00 | 2 of 3 OK created table model dbt_jonathan.customers................. [CREATE TABLE (100.0 rows, 4.3 KB processed) in 3.47s]
2020-09-09 09:26:00.053342 (Thread-1): Finished running node model.jaffle_shop.customers
2020-09-09 09:26:00.053342 (Thread-1): Began running node model.jaffle_shop.my_second_dbt_model
2020-09-09 09:26:00.054341 (Thread-1): 11:26:00 | 3 of 3 START view model dbt_jonathan.my_second_dbt_model............. [RUN]
2020-09-09 09:26:00.055341 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.my_second_dbt_model".
2020-09-09 09:26:00.055341 (Thread-1): Compiling model.jaffle_shop.my_second_dbt_model
2020-09-09 09:26:00.062402 (Thread-1): unclosed <socket.socket fd=2612, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51633), raddr=('216.58.208.42', 443)>
2020-09-09 09:26:00.062402 (Thread-1): unclosed <socket.socket fd=2596, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51632), raddr=('172.217.22.10', 443)>
2020-09-09 09:26:00.062402 (Thread-1): unclosed <socket.socket fd=2668, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51635), raddr=('216.58.208.42', 443)>
2020-09-09 09:26:00.063398 (Thread-1): unclosed <socket.socket fd=2672, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51634), raddr=('172.217.22.10', 443)>
2020-09-09 09:26:00.064384 (Thread-1): Writing injected SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-09-09 09:26:00.064384 (Thread-1): finished collecting timing info
2020-09-09 09:26:00.082401 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.my_second_dbt_model"
2020-09-09 09:26:00.083395 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:26:00.083395 (Thread-1): On model.jaffle_shop.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.my_second_dbt_model"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `dbttutorial-289007`.`dbt_jonathan`.`my_first_dbt_model`
where id = 1;


2020-09-09 09:26:00.964017 (Thread-1): finished collecting timing info
2020-09-09 09:26:00.964017 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '1008057d-23cb-449d-aaab-82969f33019c', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B87A0006D0>]}
2020-09-09 09:26:00.965023 (Thread-1): 11:26:00 | 3 of 3 OK created view model dbt_jonathan.my_second_dbt_model........ [CREATE VIEW in 0.91s]
2020-09-09 09:26:00.966006 (Thread-1): Finished running node model.jaffle_shop.my_second_dbt_model
2020-09-09 09:26:00.967012 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:26:00.968011 (MainThread): 11:26:00 | 
2020-09-09 09:26:00.968011 (MainThread): 11:26:00 | Finished running 2 table models, 1 view model in 7.50s.
2020-09-09 09:26:00.968011 (MainThread): Connection 'master' was properly closed.
2020-09-09 09:26:00.968011 (MainThread): Connection 'list_dbttutorial-289007' was properly closed.
2020-09-09 09:26:00.968011 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 09:26:00.968011 (MainThread): Connection 'model.jaffle_shop.my_second_dbt_model' was properly closed.
2020-09-09 09:26:00.976020 (MainThread): 
2020-09-09 09:26:00.977225 (MainThread): Completed successfully
2020-09-09 09:26:00.978006 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-09-09 09:26:00.979016 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B879FC3A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B879FFAD30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001B879FFAAC0>]}
2020-09-09 09:26:00.979016 (MainThread): Flushing usage events
2020-09-09 09:30:53.426640 (MainThread): Running with dbt=0.18.0
2020-09-09 09:30:53.464718 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 09:30:54.495025 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-09-09 09:30:54.495025 (MainThread): Tracking: tracking
2020-09-09 09:30:54.496016 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFC6329C10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFC76498E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFC7649C70>]}
2020-09-09 09:30:54.517932 (MainThread): Partial parsing not enabled
2020-09-09 09:30:54.518935 (MainThread): Parsing macros\adapters.sql
2020-09-09 09:30:54.536028 (MainThread): Parsing macros\catalog.sql
2020-09-09 09:30:54.542029 (MainThread): Parsing macros\etc.sql
2020-09-09 09:30:54.544015 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 09:30:54.549052 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 09:30:54.563158 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 09:30:54.566145 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 09:30:54.568768 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 09:30:54.578782 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 09:30:54.583774 (MainThread): Parsing macros\core.sql
2020-09-09 09:30:54.588865 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 09:30:54.624783 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 09:30:54.633785 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 09:30:54.634863 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 09:30:54.637449 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 09:30:54.640439 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 09:30:54.643440 (MainThread): Parsing macros\etc\query.sql
2020-09-09 09:30:54.645451 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 09:30:54.655708 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 09:30:54.668754 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 09:30:54.670752 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 09:30:54.678749 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 09:30:54.696660 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 09:30:54.721035 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 09:30:54.724035 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 09:30:54.740057 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 09:30:54.748011 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 09:30:54.753002 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 09:30:54.760066 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 09:30:54.763069 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 09:30:54.766076 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 09:30:54.768594 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 09:30:54.777189 (MainThread): Partial parsing not enabled
2020-09-09 09:30:54.817561 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:30:54.836626 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 09:30:54.905227 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFC7909FA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFC78BCB80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DFC78BCBB0>]}
2020-09-09 09:30:54.906225 (MainThread): Flushing usage events
2020-09-09 09:30:55.380457 (MainThread): Connection 'model.jaffle_shop.stg_customers' was properly closed.
2020-09-09 09:30:55.380457 (MainThread): Encountered an error:
2020-09-09 09:30:55.381464 (MainThread): Compilation Error in model customers (models\customers.sql)
  Model 'model.jaffle_shop.customers' (models\customers.sql) depends on a node named 'stg_customers.sql' which was not found
2020-09-09 09:30:55.392537 (MainThread): Traceback (most recent call last):
  File "c:\programdata\anaconda3\lib\site-packages\dbt\main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\main.py", line 255, in run_from_args
    results = task.run()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 399, in run
    self._runtime_initialize()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 678, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 350, in load_all
    manifest = loader.create_manifest()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 326, in create_manifest
    self.process_manifest(manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 298, in process_manifest
    process_refs(manifest, project_name)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 602, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 584, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 382, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 538, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models\customers.sql)
  Model 'model.jaffle_shop.customers' (models\customers.sql) depends on a node named 'stg_customers.sql' which was not found

2020-09-09 09:32:34.604594 (MainThread): Running with dbt=0.18.0
2020-09-09 09:32:34.628125 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 09:32:35.486223 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-09-09 09:32:35.486223 (MainThread): Tracking: tracking
2020-09-09 09:32:35.486223 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017306A1ACA0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017307D39A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017307D39CA0>]}
2020-09-09 09:32:35.506294 (MainThread): Partial parsing not enabled
2020-09-09 09:32:35.508290 (MainThread): Parsing macros\adapters.sql
2020-09-09 09:32:35.525342 (MainThread): Parsing macros\catalog.sql
2020-09-09 09:32:35.530613 (MainThread): Parsing macros\etc.sql
2020-09-09 09:32:35.531608 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 09:32:35.536622 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 09:32:35.548745 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 09:32:35.551739 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 09:32:35.553898 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 09:32:35.562760 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 09:32:35.568761 (MainThread): Parsing macros\core.sql
2020-09-09 09:32:35.571746 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 09:32:35.606796 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 09:32:35.614759 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 09:32:35.616760 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 09:32:35.618755 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 09:32:35.620760 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 09:32:35.622774 (MainThread): Parsing macros\etc\query.sql
2020-09-09 09:32:35.623779 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 09:32:35.631785 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 09:32:35.644817 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 09:32:35.646812 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 09:32:35.652862 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 09:32:35.670784 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 09:32:35.693815 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 09:32:35.694815 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 09:32:35.710837 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 09:32:35.716944 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 09:32:35.721850 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 09:32:35.727866 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 09:32:35.730818 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 09:32:35.732823 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 09:32:35.734823 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 09:32:35.741879 (MainThread): Partial parsing not enabled
2020-09-09 09:32:35.780958 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:32:35.805054 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 09:32:35.921485 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 09:32:35.922487 (MainThread): 
2020-09-09 09:32:35.922487 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:32:35.925497 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial-289007".
2020-09-09 09:32:35.925497 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-09 09:32:36.274072 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 09:32:36.274072 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 09:32:36.274072 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:32:36.583438 (MainThread): 11:32:36 | Concurrency: 1 threads (target='dev')
2020-09-09 09:32:36.583438 (MainThread): 11:32:36 | 
2020-09-09 09:32:36.589424 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-09-09 09:32:36.590435 (Thread-1): 11:32:36 | 1 of 2 START view model dbt_jonathan.stg_customers................... [RUN]
2020-09-09 09:32:36.591429 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 09:32:36.591429 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-09-09 09:32:36.603468 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-09-09 09:32:36.604470 (Thread-1): finished collecting timing info
2020-09-09 09:32:36.631541 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-09-09 09:32:36.632527 (Thread-1): Opening a new connection, currently in state init
2020-09-09 09:32:36.632527 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`stg_customers`
  OPTIONS()
  as select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers;


2020-09-09 09:32:38.363568 (Thread-1): finished collecting timing info
2020-09-09 09:32:38.363568 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd711d6b0-4a4a-4b50-a406-8a4136bf6ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017307F735B0>]}
2020-09-09 09:32:38.364568 (Thread-1): 11:32:38 | 1 of 2 OK created view model dbt_jonathan.stg_customers.............. [CREATE VIEW in 1.77s]
2020-09-09 09:32:38.365565 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-09-09 09:32:38.365565 (Thread-1): Began running node model.jaffle_shop.customers
2020-09-09 09:32:38.366559 (Thread-1): 11:32:38 | 2 of 2 START view model dbt_jonathan.customers....................... [RUN]
2020-09-09 09:32:38.367557 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:32:38.367557 (Thread-1): Compiling model.jaffle_shop.customers
2020-09-09 09:32:38.369564 (Thread-1): unclosed <socket.socket fd=2664, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51698), raddr=('216.58.208.42', 443)>
2020-09-09 09:32:38.370867 (Thread-1): unclosed <socket.socket fd=1868, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51697), raddr=('172.217.18.106', 443)>
2020-09-09 09:32:38.375872 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-09-09 09:32:38.377874 (Thread-1): finished collecting timing info
2020-09-09 09:32:38.386744 (Thread-1): finished collecting timing info
2020-09-09 09:32:38.386744 (Thread-1): Compilation Error in model customers (models\customers.sql)
  Trying to create view `dbttutorial-289007`.`dbt_jonathan`.`customers`, but it currently exists as a table. Either drop `dbttutorial-289007`.`dbt_jonathan`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model customers (models\customers.sql)
Traceback (most recent call last):
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 333, in safe_run
    result = self.compile_and_execute(manifest, ctx)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 276, in compile_and_execute
    result = self.run(ctx.node, manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\base.py", line 378, in run
    return self.execute(compiled_node, manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\run.py", line 233, in execute
    result = MacroGenerator(materialization_macro, context)()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 50, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 22, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 327, in __call__
    return self.call_macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 257, in call_macro
    return macro(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 675, in __call__
    return self._invoke(arguments, autoescape)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 679, in _invoke
    rv = self._func(*arguments)
  File "<template>", line 29, in macro
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\runtime.py", line 290, in call
    return __obj(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 980, in inner
    raise exc
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 977, in inner
    return func(*args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 641, in relation_wrong_type
    raise_compiler_error(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models\customers.sql)
  Trying to create view `dbttutorial-289007`.`dbt_jonathan`.`customers`, but it currently exists as a table. Either drop `dbttutorial-289007`.`dbt_jonathan`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
  
  > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
  > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
  > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
  > called by macro materialization_view_bigquery (macros\materializations\view.sql)
  > called by model customers (models\customers.sql)
2020-09-09 09:32:38.392389 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd711d6b0-4a4a-4b50-a406-8a4136bf6ce2', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017307EED430>]}
2020-09-09 09:32:38.393389 (Thread-1): 11:32:38 | 2 of 2 ERROR creating view model dbt_jonathan.customers.............. [ERROR in 0.02s]
2020-09-09 09:32:38.394543 (Thread-1): Finished running node model.jaffle_shop.customers
2020-09-09 09:32:38.395560 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:32:38.396561 (MainThread): 11:32:38 | 
2020-09-09 09:32:38.396561 (MainThread): 11:32:38 | Finished running 2 view models in 2.47s.
2020-09-09 09:32:38.396561 (MainThread): Connection 'master' was properly closed.
2020-09-09 09:32:38.396561 (MainThread): Connection 'list_dbttutorial-289007' was properly closed.
2020-09-09 09:32:38.396561 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 09:32:38.396561 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-09-09 09:32:38.401547 (MainThread): 
2020-09-09 09:32:38.402543 (MainThread): Completed with 1 error and 0 warnings:
2020-09-09 09:32:38.403543 (MainThread): 
2020-09-09 09:32:38.404546 (MainThread): Compilation Error in model customers (models\customers.sql)
2020-09-09 09:32:38.405544 (MainThread):   Trying to create view `dbttutorial-289007`.`dbt_jonathan`.`customers`, but it currently exists as a table. Either drop `dbttutorial-289007`.`dbt_jonathan`.`customers` manually, or run dbt with `--full-refresh` and dbt will drop it for you.
2020-09-09 09:32:38.405544 (MainThread):   
2020-09-09 09:32:38.406542 (MainThread):   > in macro bigquery__handle_existing_table (macros\materializations\view.sql)
2020-09-09 09:32:38.406542 (MainThread):   > called by macro handle_existing_table (macros\materializations\view\create_or_replace_view.sql)
2020-09-09 09:32:38.407545 (MainThread):   > called by macro create_or_replace_view (macros\materializations\view\create_or_replace_view.sql)
2020-09-09 09:32:38.407545 (MainThread):   > called by macro materialization_view_bigquery (macros\materializations\view.sql)
2020-09-09 09:32:38.408541 (MainThread):   > called by model customers (models\customers.sql)
2020-09-09 09:32:38.408541 (MainThread): 
Done. PASS=1 WARN=0 ERROR=1 SKIP=0 TOTAL=2
2020-09-09 09:32:38.409542 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000173080B6370>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017307EEDC70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000017307DA7670>]}
2020-09-09 09:32:38.409542 (MainThread): Flushing usage events
2020-09-09 09:32:45.403687 (MainThread): Running with dbt=0.18.0
2020-09-09 09:32:45.434291 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 09:32:46.460839 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-09-09 09:32:46.460839 (MainThread): Tracking: tracking
2020-09-09 09:32:46.461835 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000172390BAC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001723A3DB880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001723A3DBBB0>]}
2020-09-09 09:32:46.484766 (MainThread): Partial parsing not enabled
2020-09-09 09:32:46.486771 (MainThread): Parsing macros\adapters.sql
2020-09-09 09:32:46.503721 (MainThread): Parsing macros\catalog.sql
2020-09-09 09:32:46.509744 (MainThread): Parsing macros\etc.sql
2020-09-09 09:32:46.510742 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 09:32:46.515731 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 09:32:46.528752 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 09:32:46.531740 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 09:32:46.534756 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 09:32:46.544759 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 09:32:46.550816 (MainThread): Parsing macros\core.sql
2020-09-09 09:32:46.555818 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 09:32:46.592903 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 09:32:46.601930 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 09:32:46.602936 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 09:32:46.606926 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 09:32:46.610410 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 09:32:46.612440 (MainThread): Parsing macros\etc\query.sql
2020-09-09 09:32:46.614453 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 09:32:46.623449 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 09:32:46.636488 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 09:32:46.639485 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 09:32:46.646731 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 09:32:46.665790 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 09:32:46.689829 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 09:32:46.691965 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 09:32:46.708145 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 09:32:46.715032 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 09:32:46.721041 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 09:32:46.728053 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 09:32:46.731164 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 09:32:46.733155 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 09:32:46.735161 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 09:32:46.744390 (MainThread): Partial parsing not enabled
2020-09-09 09:32:46.778410 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:32:46.797437 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 09:32:46.917957 (MainThread): Found 2 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 09:32:46.918945 (MainThread): 
2020-09-09 09:32:46.920433 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:32:46.923426 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial-289007".
2020-09-09 09:32:46.924426 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-09 09:32:47.233615 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 09:32:47.233615 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 09:32:47.234635 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:32:47.531986 (MainThread): 11:32:47 | Concurrency: 1 threads (target='dev')
2020-09-09 09:32:47.532972 (MainThread): 11:32:47 | 
2020-09-09 09:32:47.541618 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-09-09 09:32:47.544618 (Thread-1): 11:32:47 | 1 of 2 START view model dbt_jonathan.stg_customers................... [RUN]
2020-09-09 09:32:47.545609 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 09:32:47.545609 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-09-09 09:32:47.559611 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-09-09 09:32:47.560611 (Thread-1): finished collecting timing info
2020-09-09 09:32:47.591618 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-09-09 09:32:47.592619 (Thread-1): Opening a new connection, currently in state init
2020-09-09 09:32:47.592619 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`stg_customers`
  OPTIONS()
  as select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers;


2020-09-09 09:32:48.531269 (Thread-1): finished collecting timing info
2020-09-09 09:32:48.531742 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c16db4c-114a-45f0-9bce-253d243d28bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001723A64C790>]}
2020-09-09 09:32:48.532737 (Thread-1): 11:32:48 | 1 of 2 OK created view model dbt_jonathan.stg_customers.............. [CREATE VIEW in 0.99s]
2020-09-09 09:32:48.532737 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-09-09 09:32:48.533729 (Thread-1): Began running node model.jaffle_shop.customers
2020-09-09 09:32:48.534743 (Thread-1): 11:32:48 | 2 of 2 START view model dbt_jonathan.customers....................... [RUN]
2020-09-09 09:32:48.534743 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:32:48.535737 (Thread-1): Compiling model.jaffle_shop.customers
2020-09-09 09:32:48.538738 (Thread-1): unclosed <socket.socket fd=2608, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51706), raddr=('216.58.208.42', 443)>
2020-09-09 09:32:48.538738 (Thread-1): unclosed <socket.socket fd=2596, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51705), raddr=('172.217.18.106', 443)>
2020-09-09 09:32:48.545733 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-09-09 09:32:48.546732 (Thread-1): finished collecting timing info
2020-09-09 09:32:48.555734 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:32:48.556742 (Thread-1): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:32:48.885680 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-09-09 09:32:48.886671 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`customers`
  OPTIONS()
  as with customers as (

    select * from `dbttutorial-289007`.`dbt_jonathan`.`stg_customers`

),

orders as (

    select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-09-09 09:32:49.723068 (Thread-1): finished collecting timing info
2020-09-09 09:32:49.724060 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c16db4c-114a-45f0-9bce-253d243d28bf', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001723A5F8130>]}
2020-09-09 09:32:49.725076 (Thread-1): 11:32:49 | 2 of 2 OK created view model dbt_jonathan.customers.................. [CREATE VIEW in 1.19s]
2020-09-09 09:32:49.726061 (Thread-1): Finished running node model.jaffle_shop.customers
2020-09-09 09:32:49.727069 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:32:49.727069 (MainThread): 11:32:49 | 
2020-09-09 09:32:49.727069 (MainThread): 11:32:49 | Finished running 2 view models in 2.81s.
2020-09-09 09:32:49.728061 (MainThread): Connection 'master' was properly closed.
2020-09-09 09:32:49.728061 (MainThread): Connection 'list_dbttutorial-289007' was properly closed.
2020-09-09 09:32:49.728061 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 09:32:49.728061 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-09-09 09:32:49.733087 (MainThread): 
2020-09-09 09:32:49.734089 (MainThread): Completed successfully
2020-09-09 09:32:49.735082 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-09-09 09:32:49.735082 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001723A6572B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001723A5398B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001723A539280>]}
2020-09-09 09:32:49.736074 (MainThread): Flushing usage events
2020-09-09 09:34:33.699674 (MainThread): Running with dbt=0.18.0
2020-09-09 09:34:33.722827 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 09:34:34.574660 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=True, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-09-09 09:34:34.575665 (MainThread): Tracking: tracking
2020-09-09 09:34:34.575665 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C949C7AB50>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C94AF9B8B0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C94AF9BC10>]}
2020-09-09 09:34:34.595676 (MainThread): Partial parsing not enabled
2020-09-09 09:34:34.596695 (MainThread): Parsing macros\adapters.sql
2020-09-09 09:34:34.613722 (MainThread): Parsing macros\catalog.sql
2020-09-09 09:34:34.619723 (MainThread): Parsing macros\etc.sql
2020-09-09 09:34:34.620723 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 09:34:34.625938 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 09:34:34.642708 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 09:34:34.647710 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 09:34:34.651710 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 09:34:34.666681 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 09:34:34.673692 (MainThread): Parsing macros\core.sql
2020-09-09 09:34:34.681693 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 09:34:34.722704 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 09:34:34.731704 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 09:34:34.732720 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 09:34:34.734639 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 09:34:34.736641 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 09:34:34.738641 (MainThread): Parsing macros\etc\query.sql
2020-09-09 09:34:34.740642 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 09:34:34.748596 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 09:34:34.761210 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 09:34:34.763204 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 09:34:34.769202 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 09:34:34.787220 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 09:34:34.810272 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 09:34:34.811290 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 09:34:34.826505 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 09:34:34.833524 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 09:34:34.838526 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 09:34:34.844572 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 09:34:34.847572 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 09:34:34.849561 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 09:34:34.851078 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 09:34:34.859077 (MainThread): Partial parsing not enabled
2020-09-09 09:34:34.898093 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:34:34.916109 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 09:34:34.930112 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-09-09 09:34:35.048126 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 09:34:35.049121 (MainThread): 
2020-09-09 09:34:35.049121 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:34:35.053140 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial-289007".
2020-09-09 09:34:35.053140 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-09 09:34:35.368319 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 09:34:35.368319 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 09:34:35.369323 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:34:35.691280 (MainThread): 11:34:35 | Concurrency: 1 threads (target='dev')
2020-09-09 09:34:35.691280 (MainThread): 11:34:35 | 
2020-09-09 09:34:35.697265 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-09-09 09:34:35.698266 (Thread-1): 11:34:35 | 1 of 3 START view model dbt_jonathan.stg_customers................... [RUN]
2020-09-09 09:34:35.698266 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 09:34:35.698266 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-09-09 09:34:35.711284 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-09-09 09:34:35.711284 (Thread-1): finished collecting timing info
2020-09-09 09:34:35.739290 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_customers"
2020-09-09 09:34:35.739290 (Thread-1): Opening a new connection, currently in state init
2020-09-09 09:34:35.740292 (Thread-1): On model.jaffle_shop.stg_customers: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_customers"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`stg_customers`
  OPTIONS()
  as select
        id as customer_id,
        first_name,
        last_name

    from `dbt-tutorial`.jaffle_shop.customers;


2020-09-09 09:34:36.990704 (Thread-1): finished collecting timing info
2020-09-09 09:34:36.991704 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26b646b-4030-4c71-9093-2696c93f81d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C94B14CF70>]}
2020-09-09 09:34:36.992704 (Thread-1): 11:34:36 | 1 of 3 OK created view model dbt_jonathan.stg_customers.............. [CREATE VIEW in 1.29s]
2020-09-09 09:34:36.993705 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-09-09 09:34:36.993705 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-09-09 09:34:36.994693 (Thread-1): 11:34:36 | 2 of 3 START view model dbt_jonathan.stg_orders...................... [RUN]
2020-09-09 09:34:36.994693 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-09-09 09:34:36.994693 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-09-09 09:34:36.999706 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-09-09 09:34:37.007689 (Thread-1): finished collecting timing info
2020-09-09 09:34:37.011697 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.stg_orders"
2020-09-09 09:34:37.012709 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:34:37.012709 (Thread-1): On model.jaffle_shop.stg_orders: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.stg_orders"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`stg_orders`
  OPTIONS()
  as select
        id as order_id,
        user_id as customer_id,
        order_date,
        status

    from `dbt-tutorial`.jaffle_shop.orders;


2020-09-09 09:34:38.039980 (Thread-1): finished collecting timing info
2020-09-09 09:34:38.039980 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26b646b-4030-4c71-9093-2696c93f81d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C94B199AF0>]}
2020-09-09 09:34:38.040983 (Thread-1): 11:34:38 | 2 of 3 OK created view model dbt_jonathan.stg_orders................. [CREATE VIEW in 1.05s]
2020-09-09 09:34:38.041981 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-09-09 09:34:38.042967 (Thread-1): Began running node model.jaffle_shop.customers
2020-09-09 09:34:38.043967 (Thread-1): 11:34:38 | 3 of 3 START view model dbt_jonathan.customers....................... [RUN]
2020-09-09 09:34:38.043967 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:34:38.044966 (Thread-1): Compiling model.jaffle_shop.customers
2020-09-09 09:34:38.050967 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-09-09 09:34:38.051968 (Thread-1): finished collecting timing info
2020-09-09 09:34:38.055969 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-09-09 09:34:38.056978 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:34:38.056978 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`customers`
  OPTIONS()
  as with customers as (

    select * from `dbttutorial-289007`.`dbt_jonathan`.`stg_customers`

),

orders as (

    select * from `dbttutorial-289007`.`dbt_jonathan`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-09-09 09:34:38.991259 (Thread-1): finished collecting timing info
2020-09-09 09:34:38.991259 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c26b646b-4030-4c71-9093-2696c93f81d8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C94B1912B0>]}
2020-09-09 09:34:38.992261 (Thread-1): 11:34:38 | 3 of 3 OK created view model dbt_jonathan.customers.................. [CREATE VIEW in 0.95s]
2020-09-09 09:34:38.993254 (Thread-1): Finished running node model.jaffle_shop.customers
2020-09-09 09:34:38.994262 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:34:38.994262 (MainThread): 11:34:38 | 
2020-09-09 09:34:38.995255 (MainThread): 11:34:38 | Finished running 3 view models in 3.95s.
2020-09-09 09:34:38.995255 (MainThread): Connection 'master' was properly closed.
2020-09-09 09:34:38.995255 (MainThread): Connection 'list_dbttutorial-289007' was properly closed.
2020-09-09 09:34:38.995255 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 09:34:38.995255 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-09-09 09:34:39.003438 (MainThread): 
2020-09-09 09:34:39.003438 (MainThread): Completed successfully
2020-09-09 09:34:39.004438 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-09-09 09:34:39.005443 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C94B132490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C94B132580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001C94C2BBDC0>]}
2020-09-09 09:34:39.006449 (MainThread): Flushing usage events
2020-09-09 09:37:21.897359 (MainThread): Running with dbt=0.18.0
2020-09-09 09:37:21.930620 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 09:37:23.000788 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-09-09 09:37:23.000788 (MainThread): Tracking: tracking
2020-09-09 09:37:23.001794 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE3C37AB20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE3D69C820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE3D69CC10>]}
2020-09-09 09:37:23.025001 (MainThread): Partial parsing not enabled
2020-09-09 09:37:23.026001 (MainThread): Parsing macros\adapters.sql
2020-09-09 09:37:23.044149 (MainThread): Parsing macros\catalog.sql
2020-09-09 09:37:23.049237 (MainThread): Parsing macros\etc.sql
2020-09-09 09:37:23.050335 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 09:37:23.055327 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 09:37:23.068021 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 09:37:23.072036 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 09:37:23.075027 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 09:37:23.085049 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 09:37:23.090974 (MainThread): Parsing macros\core.sql
2020-09-09 09:37:23.094980 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 09:37:23.131115 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 09:37:23.140288 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 09:37:23.141286 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 09:37:23.143287 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 09:37:23.145287 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 09:37:23.147287 (MainThread): Parsing macros\etc\query.sql
2020-09-09 09:37:23.148300 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 09:37:23.157350 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 09:37:23.170379 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 09:37:23.174358 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 09:37:23.180493 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 09:37:23.199687 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 09:37:23.223819 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 09:37:23.225805 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 09:37:23.241816 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 09:37:23.248830 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 09:37:23.255956 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 09:37:23.263098 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 09:37:23.266084 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 09:37:23.267092 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 09:37:23.270177 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 09:37:23.278175 (MainThread): Partial parsing not enabled
2020-09-09 09:37:23.320994 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:37:23.340472 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 09:37:23.349499 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-09-09 09:37:23.414777 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE3D94FD00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE3D91D280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001EE3D91D610>]}
2020-09-09 09:37:23.414777 (MainThread): Flushing usage events
2020-09-09 09:37:23.856740 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2020-09-09 09:37:23.857740 (MainThread): Encountered an error:
2020-09-09 09:37:23.857740 (MainThread): Compilation Error in model customers (models\customers.sql)
  Model 'model.jaffle_shop.customers' (models\customers.sql) depends on a node named 'stg_order' which was not found
2020-09-09 09:37:23.861923 (MainThread): Traceback (most recent call last):
  File "c:\programdata\anaconda3\lib\site-packages\dbt\main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\main.py", line 255, in run_from_args
    results = task.run()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 399, in run
    self._runtime_initialize()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 678, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 350, in load_all
    manifest = loader.create_manifest()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 326, in create_manifest
    self.process_manifest(manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 298, in process_manifest
    process_refs(manifest, project_name)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 602, in process_refs
    _process_refs_for_node(manifest, current_project, node)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 584, in _process_refs_for_node
    invalid_ref_fail_unless_test(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 382, in invalid_ref_fail_unless_test
    ref_target_not_found(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 538, in ref_target_not_found
    raise_compiler_error(msg, model)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models\customers.sql)
  Model 'model.jaffle_shop.customers' (models\customers.sql) depends on a node named 'stg_order' which was not found

2020-09-09 09:37:54.524483 (MainThread): Running with dbt=0.18.0
2020-09-09 09:37:54.551557 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 09:37:55.483715 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.run.RunTask'>, debug=False, defer=None, exclude=None, fail_fast=False, full_refresh=False, log_cache_events=False, log_format='default', models=['customers'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='run', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='run', write_json=True)
2020-09-09 09:37:55.483715 (MainThread): Tracking: tracking
2020-09-09 09:37:55.484716 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099A45CBE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099B7837F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099B783AF0>]}
2020-09-09 09:37:55.504727 (MainThread): Partial parsing not enabled
2020-09-09 09:37:55.505747 (MainThread): Parsing macros\adapters.sql
2020-09-09 09:37:55.522800 (MainThread): Parsing macros\catalog.sql
2020-09-09 09:37:55.528827 (MainThread): Parsing macros\etc.sql
2020-09-09 09:37:55.529846 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 09:37:55.534840 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 09:37:55.546978 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 09:37:55.549989 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 09:37:55.551996 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 09:37:55.561048 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 09:37:55.566061 (MainThread): Parsing macros\core.sql
2020-09-09 09:37:55.570095 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 09:37:55.605768 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 09:37:55.613801 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 09:37:55.615802 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 09:37:55.617802 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 09:37:55.619837 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 09:37:55.620828 (MainThread): Parsing macros\etc\query.sql
2020-09-09 09:37:55.622821 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 09:37:55.630925 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 09:37:55.643480 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 09:37:55.645495 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 09:37:55.651484 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 09:37:55.671600 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 09:37:55.694736 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 09:37:55.696755 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 09:37:55.711869 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 09:37:55.719152 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 09:37:55.724141 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 09:37:55.729758 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 09:37:55.732746 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 09:37:55.734758 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 09:37:55.736747 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 09:37:55.743741 (MainThread): Partial parsing not enabled
2020-09-09 09:37:55.777957 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:37:55.797054 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 09:37:55.804968 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-09-09 09:37:55.922692 (MainThread): Found 3 models, 0 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 09:37:55.923692 (MainThread): 
2020-09-09 09:37:55.924690 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:37:55.926690 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial-289007".
2020-09-09 09:37:55.926690 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-09 09:37:56.262653 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 09:37:56.262653 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 09:37:56.263654 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:37:56.582656 (MainThread): 11:37:56 | Concurrency: 1 threads (target='dev')
2020-09-09 09:37:56.583656 (MainThread): 11:37:56 | 
2020-09-09 09:37:56.588645 (Thread-1): Began running node model.jaffle_shop.customers
2020-09-09 09:37:56.590561 (Thread-1): 11:37:56 | 1 of 1 START view model dbt_jonathan.customers....................... [RUN]
2020-09-09 09:37:56.590561 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:37:56.591573 (Thread-1): Compiling model.jaffle_shop.customers
2020-09-09 09:37:56.605616 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-09-09 09:37:56.606612 (Thread-1): finished collecting timing info
2020-09-09 09:37:56.634626 (Thread-1): Writing runtime SQL for node "model.jaffle_shop.customers"
2020-09-09 09:37:56.635624 (Thread-1): Opening a new connection, currently in state init
2020-09-09 09:37:56.635624 (Thread-1): On model.jaffle_shop.customers: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "model.jaffle_shop.customers"} */


  create or replace view `dbttutorial-289007`.`dbt_jonathan`.`customers`
  OPTIONS()
  as with customers as (

    select * from `dbttutorial-289007`.`dbt_jonathan`.`stg_customers`

),

orders as (

    select * from `dbttutorial-289007`.`dbt_jonathan`.`stg_orders`

),

customer_orders as (

    select
        customer_id,

        min(order_date) as first_order_date,
        max(order_date) as most_recent_order_date,
        count(order_id) as number_of_orders

    from orders

    group by 1

),


final as (

    select
        customers.customer_id,
        customers.first_name,
        customers.last_name,
        customer_orders.first_order_date,
        customer_orders.most_recent_order_date,
        coalesce(customer_orders.number_of_orders, 0) as number_of_orders

    from customers

    left join customer_orders using (customer_id)

)

select * from final;


2020-09-09 09:37:58.535088 (Thread-1): finished collecting timing info
2020-09-09 09:37:58.536088 (Thread-1): Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '2d51f5c9-48c7-4063-88e5-aef6e6caf7a4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099B911310>]}
2020-09-09 09:37:58.537088 (Thread-1): 11:37:58 | 1 of 1 OK created view model dbt_jonathan.customers.................. [CREATE VIEW in 1.95s]
2020-09-09 09:37:58.538097 (Thread-1): Finished running node model.jaffle_shop.customers
2020-09-09 09:37:58.539514 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:37:58.539514 (MainThread): 11:37:58 | 
2020-09-09 09:37:58.540505 (MainThread): 11:37:58 | Finished running 1 view model in 2.62s.
2020-09-09 09:37:58.540505 (MainThread): Connection 'master' was properly closed.
2020-09-09 09:37:58.540505 (MainThread): Connection 'list_dbttutorial-289007' was properly closed.
2020-09-09 09:37:58.540505 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 09:37:58.540505 (MainThread): Connection 'model.jaffle_shop.customers' was properly closed.
2020-09-09 09:37:58.544507 (MainThread): 
2020-09-09 09:37:58.544507 (MainThread): Completed successfully
2020-09-09 09:37:58.545514 (MainThread): 
Done. PASS=1 WARN=0 ERROR=0 SKIP=0 TOTAL=1
2020-09-09 09:37:58.545514 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099B8E3A30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099B8E3A00>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000002099B8E3BE0>]}
2020-09-09 09:37:58.546505 (MainThread): Flushing usage events
2020-09-09 09:40:29.675190 (MainThread): Running with dbt=0.18.0
2020-09-09 09:40:29.701754 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 09:40:30.630510 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-09-09 09:40:30.631506 (MainThread): Tracking: tracking
2020-09-09 09:40:30.631506 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2A2BABB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2B5DA820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2B5DABB0>]}
2020-09-09 09:40:30.651553 (MainThread): Partial parsing not enabled
2020-09-09 09:40:30.653548 (MainThread): Parsing macros\adapters.sql
2020-09-09 09:40:30.670574 (MainThread): Parsing macros\catalog.sql
2020-09-09 09:40:30.675566 (MainThread): Parsing macros\etc.sql
2020-09-09 09:40:30.677585 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 09:40:30.681599 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 09:40:30.694516 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 09:40:30.697516 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 09:40:30.699527 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 09:40:30.709602 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 09:40:30.714524 (MainThread): Parsing macros\core.sql
2020-09-09 09:40:30.718523 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 09:40:30.754529 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 09:40:30.762494 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 09:40:30.764506 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 09:40:30.766506 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 09:40:30.768494 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 09:40:30.770299 (MainThread): Parsing macros\etc\query.sql
2020-09-09 09:40:30.772307 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 09:40:30.780321 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 09:40:30.793288 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 09:40:30.795289 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 09:40:30.802295 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 09:40:30.820274 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 09:40:30.843231 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 09:40:30.845128 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 09:40:30.861158 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 09:40:30.867172 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 09:40:30.872173 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 09:40:30.879175 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 09:40:30.882200 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 09:40:30.884201 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 09:40:30.886201 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 09:40:30.893183 (MainThread): Partial parsing not enabled
2020-09-09 09:40:30.927209 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:40:30.946267 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 09:40:30.954178 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-09-09 09:40:31.131246 (MainThread): Found 3 models, 2 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 09:40:31.133232 (MainThread): 
2020-09-09 09:40:31.133232 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:40:31.139232 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 09:40:31.139232 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 09:40:31.139232 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:40:31.460852 (MainThread): 11:40:31 | Concurrency: 1 threads (target='dev')
2020-09-09 09:40:31.461841 (MainThread): 11:40:31 | 
2020-09-09 09:40:31.466842 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2020-09-09 09:40:31.466842 (Thread-1): 11:40:31 | 1 of 2 START test not_null_customers_customer_id..................... [RUN]
2020-09-09 09:40:31.467842 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2020-09-09 09:40:31.467842 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2020-09-09 09:40:31.483844 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2020-09-09 09:40:31.484845 (Thread-1): finished collecting timing info
2020-09-09 09:40:31.485846 (Thread-1): Opening a new connection, currently in state init
2020-09-09 09:40:31.485846 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `dbttutorial-289007`.`dbt_jonathan`.`customers`
where customer_id is null



2020-09-09 09:40:34.671889 (Thread-1): finished collecting timing info
2020-09-09 09:40:34.671889 (Thread-1): 11:40:34 | 1 of 2 PASS not_null_customers_customer_id........................... [PASS in 3.21s]
2020-09-09 09:41:01.326564 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2020-09-09 09:41:01.326564 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2020-09-09 09:41:01.326564 (Thread-1): 11:41:01 | 2 of 2 START test unique_customers_customer_id....................... [RUN]
2020-09-09 09:41:01.327564 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2020-09-09 09:41:01.327564 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2020-09-09 09:41:01.335566 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2020-09-09 09:41:01.343569 (Thread-1): finished collecting timing info
2020-09-09 09:41:01.343569 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:41:01.344569 (Thread-1): On test.jaffle_shop.unique_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `dbttutorial-289007`.`dbt_jonathan`.`customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2020-09-09 09:41:04.180025 (Thread-1): finished collecting timing info
2020-09-09 09:41:04.180025 (Thread-1): 11:41:04 | 2 of 2 PASS unique_customers_customer_id............................. [PASS in 2.85s]
2020-09-09 09:41:04.181021 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2020-09-09 09:41:04.182006 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:41:04.183005 (MainThread): 11:41:04 | 
2020-09-09 09:41:04.183005 (MainThread): 11:41:04 | Finished running 2 tests in 33.05s.
2020-09-09 09:41:04.183005 (MainThread): Connection 'master' was properly closed.
2020-09-09 09:41:04.184005 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 09:41:04.184005 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id' was properly closed.
2020-09-09 09:41:04.186005 (MainThread): unclosed <socket.socket fd=1896, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51799), raddr=('172.217.16.138', 443)>
2020-09-09 09:41:04.187005 (MainThread): unclosed <socket.socket fd=752, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51800), raddr=('216.58.208.42', 443)>
2020-09-09 09:41:04.190015 (MainThread): 
2020-09-09 09:41:04.190015 (MainThread): Completed successfully
2020-09-09 09:41:04.191017 (MainThread): 
Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
2020-09-09 09:41:04.191017 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2B9A5DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2B9A5EE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000019F2B9AC5B0>]}
2020-09-09 09:41:04.191017 (MainThread): Flushing usage events
2020-09-09 09:45:25.036318 (MainThread): Running with dbt=0.18.0
2020-09-09 09:45:25.065713 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 09:45:26.150360 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-09-09 09:45:26.150360 (MainThread): Tracking: tracking
2020-09-09 09:45:26.151384 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD682C9B80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD695EC9A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD695ECC40>]}
2020-09-09 09:45:26.173197 (MainThread): Partial parsing not enabled
2020-09-09 09:45:26.175206 (MainThread): Parsing macros\adapters.sql
2020-09-09 09:45:26.193280 (MainThread): Parsing macros\catalog.sql
2020-09-09 09:45:26.198273 (MainThread): Parsing macros\etc.sql
2020-09-09 09:45:26.200273 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 09:45:26.205192 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 09:45:26.217220 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 09:45:26.220221 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 09:45:26.224186 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 09:45:26.234207 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 09:45:26.240208 (MainThread): Parsing macros\core.sql
2020-09-09 09:45:26.245236 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 09:45:26.281301 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 09:45:26.290303 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 09:45:26.293720 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 09:45:26.295721 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 09:45:26.298722 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 09:45:26.300722 (MainThread): Parsing macros\etc\query.sql
2020-09-09 09:45:26.301727 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 09:45:26.310834 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 09:45:26.324077 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 09:45:26.326085 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 09:45:26.333079 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 09:45:26.352036 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 09:45:26.375057 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 09:45:26.377063 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 09:45:26.393120 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 09:45:26.400107 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 09:45:26.407124 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 09:45:26.413143 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 09:45:26.416144 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 09:45:26.418145 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 09:45:26.422521 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 09:45:26.429509 (MainThread): Partial parsing not enabled
2020-09-09 09:45:26.464743 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 09:45:26.484372 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 09:45:26.493321 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-09-09 09:45:26.817995 (MainThread): Found 3 models, 9 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 09:45:26.819982 (MainThread): 
2020-09-09 09:45:26.820982 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:45:26.833927 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 09:45:26.833927 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 09:45:26.834924 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 09:45:27.179157 (MainThread): 11:45:27 | Concurrency: 1 threads (target='dev')
2020-09-09 09:45:27.179157 (MainThread): 11:45:27 | 
2020-09-09 09:45:27.184150 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-09-09 09:45:27.184150 (Thread-1): 11:45:27 | 1 of 9 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2020-09-09 09:45:27.185151 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2020-09-09 09:45:27.185151 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-09-09 09:45:27.204155 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2020-09-09 09:45:27.210969 (Thread-1): finished collecting timing info
2020-09-09 09:45:27.212425 (Thread-1): Opening a new connection, currently in state init
2020-09-09 09:45:27.212425 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `dbttutorial-289007`.`dbt_jonathan`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'placed','shipped','completed','return_pending','returned'
    )
)

select count(*) as validation_errors
from validation_errors



2020-09-09 09:45:30.237164 (Thread-1): finished collecting timing info
2020-09-09 09:45:30.238163 (Thread-1): 11:45:30 | 1 of 9 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 3.05s]
2020-09-09 09:45:30.239163 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-09-09 09:45:30.239163 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2020-09-09 09:45:30.240170 (Thread-1): 11:45:30 | 2 of 9 START test not_null_customers_customer_id..................... [RUN]
2020-09-09 09:45:30.240170 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2020-09-09 09:45:30.240170 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2020-09-09 09:45:30.248165 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2020-09-09 09:45:30.249166 (Thread-1): finished collecting timing info
2020-09-09 09:45:30.249166 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:45:30.250167 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `dbttutorial-289007`.`dbt_jonathan`.`customers`
where customer_id is null



2020-09-09 09:45:32.042596 (Thread-1): finished collecting timing info
2020-09-09 09:45:32.043513 (Thread-1): 11:45:32 | 2 of 9 PASS not_null_customers_customer_id........................... [PASS in 1.80s]
2020-09-09 09:45:32.043513 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2020-09-09 09:45:32.044512 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-09-09 09:45:32.044512 (Thread-1): 11:45:32 | 3 of 9 START test not_null_stg_customers_customer_id................. [RUN]
2020-09-09 09:45:32.044512 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2020-09-09 09:45:32.044512 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2020-09-09 09:45:32.047522 (Thread-1): unclosed <socket.socket fd=2548, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51847), raddr=('172.217.18.106', 443)>
2020-09-09 09:45:32.047522 (Thread-1): unclosed <socket.socket fd=2528, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51848), raddr=('216.58.208.42', 443)>
2020-09-09 09:45:32.052690 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2020-09-09 09:45:32.053675 (Thread-1): finished collecting timing info
2020-09-09 09:45:32.054679 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:45:32.055677 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `dbttutorial-289007`.`dbt_jonathan`.`stg_customers`
where customer_id is null



2020-09-09 09:45:33.584208 (Thread-1): finished collecting timing info
2020-09-09 09:45:33.584208 (Thread-1): 11:45:33 | 3 of 9 PASS not_null_stg_customers_customer_id....................... [PASS in 1.54s]
2020-09-09 09:45:33.585214 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-09-09 09:45:33.585214 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_customer_id
2020-09-09 09:45:33.585214 (Thread-1): 11:45:33 | 4 of 9 START test not_null_stg_orders_customer_id.................... [RUN]
2020-09-09 09:45:33.586214 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_customer_id".
2020-09-09 09:45:33.586214 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_customer_id
2020-09-09 09:45:33.595512 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_customer_id"
2020-09-09 09:45:33.596512 (Thread-1): finished collecting timing info
2020-09-09 09:45:33.596512 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:45:33.597507 (Thread-1): On test.jaffle_shop.not_null_stg_orders_customer_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_customer_id"} */

    
    



select count(*) as validation_errors
from `dbttutorial-289007`.`dbt_jonathan`.`stg_orders`
where customer_id is null



2020-09-09 09:45:35.280277 (Thread-1): finished collecting timing info
2020-09-09 09:45:35.280277 (Thread-1): 11:45:35 | 4 of 9 PASS not_null_stg_orders_customer_id.......................... [PASS in 1.69s]
2020-09-09 09:45:35.281656 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_customer_id
2020-09-09 09:45:35.281656 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-09-09 09:45:35.281656 (Thread-1): 11:45:35 | 5 of 9 START test not_null_stg_orders_order_id....................... [RUN]
2020-09-09 09:45:35.281656 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-09-09 09:45:35.281656 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-09-09 09:45:35.283660 (Thread-1): unclosed <socket.socket fd=2424, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51851), raddr=('172.217.18.106', 443)>
2020-09-09 09:45:35.283660 (Thread-1): unclosed <socket.socket fd=2736, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51852), raddr=('216.58.208.42', 443)>
2020-09-09 09:45:35.291647 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-09-09 09:45:35.293647 (Thread-1): finished collecting timing info
2020-09-09 09:45:35.293647 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:45:35.293647 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from `dbttutorial-289007`.`dbt_jonathan`.`stg_orders`
where order_id is null



2020-09-09 09:45:37.340706 (Thread-1): finished collecting timing info
2020-09-09 09:45:37.341716 (Thread-1): 11:45:37 | 5 of 9 PASS not_null_stg_orders_order_id............................. [PASS in 2.06s]
2020-09-09 09:45:37.341716 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-09-09 09:45:37.341716 (Thread-1): Began running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-09-09 09:45:37.341716 (Thread-1): 11:45:37 | 6 of 9 START test relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [RUN]
2020-09-09 09:45:37.342717 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_".
2020-09-09 09:45:37.342717 (Thread-1): Compiling test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-09-09 09:45:37.344710 (Thread-1): unclosed <socket.socket fd=2420, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51854), raddr=('172.217.18.106', 443)>
2020-09-09 09:45:37.345717 (Thread-1): unclosed <socket.socket fd=2724, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51855), raddr=('216.58.208.42', 443)>
2020-09-09 09:45:37.352699 (Thread-1): Writing injected SQL for node "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"
2020-09-09 09:45:37.353688 (Thread-1): finished collecting timing info
2020-09-09 09:45:37.353688 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:45:37.354692 (Thread-1): On test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_"} */

    
    




select count(*) as validation_errors
from (
    select customer_id as id from `dbttutorial-289007`.`dbt_jonathan`.`stg_orders`
) as child
left join (
    select customer_id as id from `dbttutorial-289007`.`dbt_jonathan`.`stg_customers`
) as parent on parent.id = child.id
where child.id is not null
  and parent.id is null



2020-09-09 09:45:39.226175 (Thread-1): finished collecting timing info
2020-09-09 09:45:39.226175 (Thread-1): 11:45:39 | 6 of 9 PASS relationships_stg_orders_customer_id__customer_id__ref_stg_customers_ [PASS in 1.88s]
2020-09-09 09:45:39.227180 (Thread-1): Finished running node test.jaffle_shop.relationships_stg_orders_customer_id__customer_id__ref_stg_customers_
2020-09-09 09:45:39.227180 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2020-09-09 09:45:39.228176 (Thread-1): 11:45:39 | 7 of 9 START test unique_customers_customer_id....................... [RUN]
2020-09-09 09:45:39.228176 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2020-09-09 09:45:39.228176 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2020-09-09 09:45:39.231177 (Thread-1): unclosed <socket.socket fd=2572, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51846), raddr=('216.58.208.42', 443)>
2020-09-09 09:45:39.231177 (Thread-1): unclosed <socket.socket fd=2628, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51845), raddr=('172.217.18.106', 443)>
2020-09-09 09:45:39.233177 (Thread-1): unclosed <socket.socket fd=2680, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51849), raddr=('172.217.18.106', 443)>
2020-09-09 09:45:39.233177 (Thread-1): unclosed <socket.socket fd=2528, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51850), raddr=('216.58.208.42', 443)>
2020-09-09 09:45:39.238178 (Thread-1): unclosed <socket.socket fd=2732, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51856), raddr=('172.217.18.106', 443)>
2020-09-09 09:45:39.238178 (Thread-1): unclosed <socket.socket fd=2808, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51857), raddr=('216.58.208.42', 443)>
2020-09-09 09:45:39.244181 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2020-09-09 09:45:39.245181 (Thread-1): finished collecting timing info
2020-09-09 09:45:39.245181 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:45:39.246183 (Thread-1): On test.jaffle_shop.unique_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `dbttutorial-289007`.`dbt_jonathan`.`customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2020-09-09 09:45:40.517129 (Thread-1): finished collecting timing info
2020-09-09 09:45:40.518129 (Thread-1): 11:45:40 | 7 of 9 PASS unique_customers_customer_id............................. [PASS in 1.29s]
2020-09-09 09:45:40.518129 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2020-09-09 09:45:40.518129 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2020-09-09 09:45:40.519129 (Thread-1): 11:45:40 | 8 of 9 START test unique_stg_customers_customer_id................... [RUN]
2020-09-09 09:45:40.519129 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2020-09-09 09:45:40.519129 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2020-09-09 09:45:40.529141 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2020-09-09 09:45:40.530131 (Thread-1): finished collecting timing info
2020-09-09 09:45:40.530131 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:45:40.531131 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `dbttutorial-289007`.`dbt_jonathan`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2020-09-09 09:45:42.804459 (Thread-1): finished collecting timing info
2020-09-09 09:45:42.805458 (Thread-1): 11:45:42 | 8 of 9 PASS unique_stg_customers_customer_id......................... [PASS in 2.29s]
2020-09-09 09:45:42.806453 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2020-09-09 09:45:42.806453 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-09-09 09:45:42.806453 (Thread-1): 11:45:42 | 9 of 9 START test unique_stg_orders_order_id......................... [RUN]
2020-09-09 09:45:42.807451 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-09-09 09:45:42.807451 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-09-09 09:45:42.809459 (Thread-1): unclosed <socket.socket fd=2472, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51860), raddr=('172.217.18.106', 443)>
2020-09-09 09:45:42.810459 (Thread-1): unclosed <socket.socket fd=2732, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 51861), raddr=('216.58.208.42', 443)>
2020-09-09 09:45:42.816227 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-09-09 09:45:42.817225 (Thread-1): finished collecting timing info
2020-09-09 09:45:42.818226 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 09:45:42.818226 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from (

    select
        order_id

    from `dbttutorial-289007`.`dbt_jonathan`.`stg_orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors



2020-09-09 09:45:44.641398 (Thread-1): finished collecting timing info
2020-09-09 09:45:44.641398 (Thread-1): 11:45:44 | 9 of 9 PASS unique_stg_orders_order_id............................... [PASS in 1.83s]
2020-09-09 09:45:44.642397 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-09-09 09:45:44.644383 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 09:45:44.644383 (MainThread): 11:45:44 | 
2020-09-09 09:45:44.644383 (MainThread): 11:45:44 | Finished running 9 tests in 17.82s.
2020-09-09 09:45:44.645391 (MainThread): Connection 'master' was properly closed.
2020-09-09 09:45:44.645391 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 09:45:44.645391 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id' was properly closed.
2020-09-09 09:45:44.667536 (MainThread): 
2020-09-09 09:45:44.667536 (MainThread): Completed successfully
2020-09-09 09:45:44.673526 (MainThread): 
Done. PASS=9 WARN=0 ERROR=0 SKIP=0 TOTAL=9
2020-09-09 09:45:44.677522 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD699E0280>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD69A528E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001DD69A528B0>]}
2020-09-09 09:45:44.677522 (MainThread): Flushing usage events
2020-09-09 10:09:23.017271 (MainThread): Running with dbt=0.18.0
2020-09-09 10:09:23.041078 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 10:09:23.901584 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-09-09 10:09:23.901584 (MainThread): Tracking: tracking
2020-09-09 10:09:23.902584 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA58FCCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA6C1B820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA6C1BBE0>]}
2020-09-09 10:09:23.922570 (MainThread): Partial parsing not enabled
2020-09-09 10:09:23.923589 (MainThread): Parsing macros\adapters.sql
2020-09-09 10:09:23.941576 (MainThread): Parsing macros\catalog.sql
2020-09-09 10:09:23.946575 (MainThread): Parsing macros\etc.sql
2020-09-09 10:09:23.947574 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 10:09:23.952576 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 10:09:23.964578 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 10:09:23.967580 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 10:09:23.969599 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 10:09:23.978589 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 10:09:23.983590 (MainThread): Parsing macros\core.sql
2020-09-09 10:09:23.987603 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 10:09:24.024592 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 10:09:24.032594 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 10:09:24.033608 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 10:09:24.035602 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 10:09:24.037603 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 10:09:24.039615 (MainThread): Parsing macros\etc\query.sql
2020-09-09 10:09:24.041596 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 10:09:24.050618 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 10:09:24.062600 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 10:09:24.064600 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 10:09:24.071622 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 10:09:24.089607 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 10:09:24.112612 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 10:09:24.114620 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 10:09:24.129616 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 10:09:24.136618 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 10:09:24.141619 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 10:09:24.147620 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 10:09:24.150621 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 10:09:24.152621 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 10:09:24.154621 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 10:09:24.161637 (MainThread): Partial parsing not enabled
2020-09-09 10:09:24.195650 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 10:09:24.214654 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 10:09:24.222656 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-09-09 10:09:24.476695 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 10:09:24.477697 (MainThread): 
2020-09-09 10:09:24.477697 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 10:09:24.487699 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 10:09:24.487699 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-09 10:09:24.488704 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 10:09:24.824759 (MainThread): 12:09:24 | Concurrency: 1 threads (target='dev')
2020-09-09 10:09:24.824759 (MainThread): 12:09:24 | 
2020-09-09 10:09:24.830755 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-09-09 10:09:24.831755 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 10:09:24.831755 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-09-09 10:09:24.846764 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-09-09 10:09:24.846764 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.847745 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.847745 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-09-09 10:09:24.847745 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-09-09 10:09:24.847745 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-09-09 10:09:24.847745 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-09-09 10:09:24.853766 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-09-09 10:09:24.859763 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.859763 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.860746 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-09-09 10:09:24.860746 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-09-09 10:09:24.860746 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2020-09-09 10:09:24.860746 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2020-09-09 10:09:24.874770 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2020-09-09 10:09:24.874770 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.874770 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.875751 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-09-09 10:09:24.875751 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2020-09-09 10:09:24.875751 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2020-09-09 10:09:24.875751 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2020-09-09 10:09:24.882772 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2020-09-09 10:09:24.883772 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.883772 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.884753 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2020-09-09 10:09:24.884753 (Thread-1): Began running node model.jaffle_shop.customers
2020-09-09 10:09:24.884753 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 10:09:24.884753 (Thread-1): Compiling model.jaffle_shop.customers
2020-09-09 10:09:24.891774 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-09-09 10:09:24.892774 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.892774 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.893755 (Thread-1): Finished running node model.jaffle_shop.customers
2020-09-09 10:09:24.893755 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-09-09 10:09:24.893755 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2020-09-09 10:09:24.893755 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-09-09 10:09:24.903777 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2020-09-09 10:09:24.904777 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.905777 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.905777 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-09-09 10:09:24.905777 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-09-09 10:09:24.905777 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-09-09 10:09:24.905777 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-09-09 10:09:24.913780 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-09-09 10:09:24.913780 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.914770 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.914770 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-09-09 10:09:24.914770 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-09-09 10:09:24.914770 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-09-09 10:09:24.914770 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-09-09 10:09:24.922783 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-09-09 10:09:24.922783 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.923762 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.923762 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-09-09 10:09:24.923762 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2020-09-09 10:09:24.923762 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2020-09-09 10:09:24.923762 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2020-09-09 10:09:24.931785 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2020-09-09 10:09:24.931785 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.932764 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.932764 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2020-09-09 10:09:24.932764 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2020-09-09 10:09:24.932764 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2020-09-09 10:09:24.932764 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2020-09-09 10:09:24.939785 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2020-09-09 10:09:24.940780 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.940780 (Thread-1): finished collecting timing info
2020-09-09 10:09:24.941785 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2020-09-09 10:09:24.942766 (MainThread): Connection 'master' was properly closed.
2020-09-09 10:09:24.942766 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 10:09:24.942766 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id' was properly closed.
2020-09-09 10:09:24.965786 (MainThread): 12:09:24 | Done.
2020-09-09 10:09:24.972771 (MainThread): Acquiring new bigquery connection "generate_catalog".
2020-09-09 10:09:24.972771 (MainThread): 12:09:24 | Building catalog
2020-09-09 10:09:24.985785 (MainThread): Opening a new connection, currently in state init
2020-09-09 10:09:25.321730 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "dbttutorial-289007.information_schema".
2020-09-09 10:09:25.334748 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 10:09:25.335751 (ThreadPoolExecutor-1_0): On dbttutorial-289007.information_schema: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "dbttutorial-289007.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbttutorial-289007`.`dbt_jonathan`.__TABLES__
        where (upper(dataset_id) = upper('dbt_jonathan'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbttutorial-289007`.`dbt_jonathan`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbttutorial-289007`.`dbt_jonathan`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2020-09-09 10:09:31.030215 (MainThread): 12:09:31 | Catalog written to C:\Users\Jonathan Jansen\Documents\dbt\dbt-tutorial\target\catalog.json
2020-09-09 10:09:31.030215 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA58FCCD0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA6FBD1F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000025DA6FBD160>]}
2020-09-09 10:09:31.030215 (MainThread): Flushing usage events
2020-09-09 10:09:31.484959 (MainThread): Connection 'generate_catalog' was properly closed.
2020-09-09 10:09:31.485966 (MainThread): Connection 'dbttutorial-289007.information_schema' was properly closed.
2020-09-09 10:10:23.933711 (MainThread): Running with dbt=0.18.0
2020-09-09 10:10:23.959318 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 10:10:24.872691 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2020-09-09 10:10:24.873691 (MainThread): Tracking: tracking
2020-09-09 10:10:24.873691 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F7BFCD90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F8F206A0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001A5F8F20A90>]}
2020-09-09 10:10:24.876704 (MainThread): Serving docs at 0.0.0.0:8080
2020-09-09 10:10:24.876704 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-09-09 10:10:24.879611 (MainThread): Press Ctrl+C to exit.


2020-09-09 10:14:38.239782 (MainThread): Running with dbt=0.18.0
2020-09-09 10:14:38.266773 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 10:14:39.181093 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-09-09 10:14:39.181093 (MainThread): Tracking: tracking
2020-09-09 10:14:39.182093 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0C52BBB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0D84E7C0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0D84EB80>]}
2020-09-09 10:14:39.202110 (MainThread): Partial parsing not enabled
2020-09-09 10:14:39.203105 (MainThread): Parsing macros\adapters.sql
2020-09-09 10:14:39.220114 (MainThread): Parsing macros\catalog.sql
2020-09-09 10:14:39.225115 (MainThread): Parsing macros\etc.sql
2020-09-09 10:14:39.227110 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 10:14:39.231116 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 10:14:39.244120 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 10:14:39.247120 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 10:14:39.249109 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 10:14:39.258122 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 10:14:39.263123 (MainThread): Parsing macros\core.sql
2020-09-09 10:14:39.267124 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 10:14:39.303127 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 10:14:39.311134 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 10:14:39.312129 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 10:14:39.314135 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 10:14:39.316135 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 10:14:39.318136 (MainThread): Parsing macros\etc\query.sql
2020-09-09 10:14:39.320131 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 10:14:39.329134 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 10:14:39.341127 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 10:14:39.344137 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 10:14:39.350124 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 10:14:39.368142 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 10:14:39.391147 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 10:14:39.394148 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 10:14:39.409151 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 10:14:39.416153 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 10:14:39.421154 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 10:14:39.427155 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 10:14:39.431156 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 10:14:39.433156 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 10:14:39.435157 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 10:14:39.443159 (MainThread): Partial parsing not enabled
2020-09-09 10:14:39.476166 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 10:14:39.495170 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 10:14:39.503165 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-09-09 10:14:39.756214 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 10:14:39.757214 (MainThread): 
2020-09-09 10:14:39.758214 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 10:14:39.767224 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 10:14:39.768227 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 10:14:39.768227 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 10:14:40.086822 (MainThread): 12:14:40 | Concurrency: 1 threads (target='dev')
2020-09-09 10:14:40.086822 (MainThread): 12:14:40 | 
2020-09-09 10:14:40.093837 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed
2020-09-09 10:14:40.094831 (Thread-1): 12:14:40 | 1 of 7 START test accepted_values_stg_orders_status__placed.......... [RUN]
2020-09-09 10:14:40.094831 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed".
2020-09-09 10:14:40.094831 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed
2020-09-09 10:14:40.111846 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed"
2020-09-09 10:14:40.112835 (Thread-1): finished collecting timing info
2020-09-09 10:14:40.113827 (Thread-1): Opening a new connection, currently in state init
2020-09-09 10:14:40.113827 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `dbttutorial-289007`.`dbt_jonathan`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'placed'
    )
)

select count(*) as validation_errors
from validation_errors



2020-09-09 10:14:42.784429 (Thread-1): finished collecting timing info
2020-09-09 10:14:42.791462 (Thread-1): 12:14:42 | 1 of 7 FAIL 4 accepted_values_stg_orders_status__placed.............. [FAIL 4 in 2.69s]
2020-09-09 10:14:42.792458 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed
2020-09-09 10:14:42.792458 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2020-09-09 10:14:42.793454 (Thread-1): 12:14:42 | 2 of 7 START test not_null_customers_customer_id..................... [RUN]
2020-09-09 10:14:42.794454 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2020-09-09 10:14:42.794454 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2020-09-09 10:14:42.796454 (Thread-1): unclosed <socket.socket fd=2580, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 52070), raddr=('216.58.207.42', 443)>
2020-09-09 10:14:42.796454 (Thread-1): unclosed <socket.socket fd=2584, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 52071), raddr=('216.58.208.42', 443)>
2020-09-09 10:14:42.808456 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2020-09-09 10:14:42.809457 (Thread-1): finished collecting timing info
2020-09-09 10:14:42.809457 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 10:14:42.809457 (Thread-1): On test.jaffle_shop.not_null_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `dbttutorial-289007`.`dbt_jonathan`.`customers`
where customer_id is null



2020-09-09 10:14:44.579342 (Thread-1): finished collecting timing info
2020-09-09 10:14:44.580341 (Thread-1): 12:14:44 | 2 of 7 PASS not_null_customers_customer_id........................... [PASS in 1.79s]
2020-09-09 10:14:44.581339 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2020-09-09 10:14:44.581339 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-09-09 10:14:44.581339 (Thread-1): 12:14:44 | 3 of 7 START test not_null_stg_customers_customer_id................. [RUN]
2020-09-09 10:14:44.581339 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2020-09-09 10:14:44.581339 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2020-09-09 10:14:44.584348 (Thread-1): unclosed <socket.socket fd=676, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 52073), raddr=('216.58.207.42', 443)>
2020-09-09 10:14:44.584348 (Thread-1): unclosed <socket.socket fd=2596, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 52074), raddr=('216.58.208.42', 443)>
2020-09-09 10:14:44.590349 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2020-09-09 10:14:44.591343 (Thread-1): finished collecting timing info
2020-09-09 10:14:44.591343 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 10:14:44.591343 (Thread-1): On test.jaffle_shop.not_null_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from `dbttutorial-289007`.`dbt_jonathan`.`stg_customers`
where customer_id is null



2020-09-09 10:14:45.910103 (Thread-1): finished collecting timing info
2020-09-09 10:14:45.910103 (Thread-1): 12:14:45 | 3 of 7 PASS not_null_stg_customers_customer_id....................... [PASS in 1.33s]
2020-09-09 10:14:45.911101 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-09-09 10:14:45.911101 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-09-09 10:14:45.911101 (Thread-1): 12:14:45 | 4 of 7 START test not_null_stg_orders_order_id....................... [RUN]
2020-09-09 10:14:45.911101 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-09-09 10:14:45.911101 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-09-09 10:14:45.919125 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-09-09 10:14:45.920105 (Thread-1): finished collecting timing info
2020-09-09 10:14:45.921102 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 10:14:45.921102 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from `dbttutorial-289007`.`dbt_jonathan`.`stg_orders`
where order_id is null



2020-09-09 10:14:47.668068 (Thread-1): finished collecting timing info
2020-09-09 10:14:47.669058 (Thread-1): 12:14:47 | 4 of 7 PASS not_null_stg_orders_order_id............................. [PASS in 1.76s]
2020-09-09 10:14:47.670056 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-09-09 10:14:47.670056 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2020-09-09 10:14:47.671056 (Thread-1): 12:14:47 | 5 of 7 START test unique_customers_customer_id....................... [RUN]
2020-09-09 10:14:47.671056 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2020-09-09 10:14:47.672057 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2020-09-09 10:14:47.674064 (Thread-1): unclosed <socket.socket fd=2664, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 52077), raddr=('216.58.207.42', 443)>
2020-09-09 10:14:47.674064 (Thread-1): unclosed <socket.socket fd=2672, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 52078), raddr=('216.58.208.42', 443)>
2020-09-09 10:14:47.680580 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2020-09-09 10:14:47.681579 (Thread-1): finished collecting timing info
2020-09-09 10:14:47.681579 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 10:14:47.681579 (Thread-1): On test.jaffle_shop.unique_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `dbttutorial-289007`.`dbt_jonathan`.`customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2020-09-09 10:14:49.456323 (Thread-1): finished collecting timing info
2020-09-09 10:14:49.457715 (Thread-1): 12:14:49 | 5 of 7 PASS unique_customers_customer_id............................. [PASS in 1.79s]
2020-09-09 10:14:49.458700 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2020-09-09 10:14:49.458700 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2020-09-09 10:14:49.458700 (Thread-1): 12:14:49 | 6 of 7 START test unique_stg_customers_customer_id................... [RUN]
2020-09-09 10:14:49.458700 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2020-09-09 10:14:49.458700 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2020-09-09 10:14:49.466701 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2020-09-09 10:14:49.467808 (Thread-1): finished collecting timing info
2020-09-09 10:14:49.468708 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 10:14:49.469705 (Thread-1): On test.jaffle_shop.unique_stg_customers_customer_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_customers_customer_id"} */

    
    



select count(*) as validation_errors
from (

    select
        customer_id

    from `dbttutorial-289007`.`dbt_jonathan`.`stg_customers`
    where customer_id is not null
    group by customer_id
    having count(*) > 1

) validation_errors



2020-09-09 10:14:50.776188 (Thread-1): finished collecting timing info
2020-09-09 10:14:50.777245 (Thread-1): 12:14:50 | 6 of 7 PASS unique_stg_customers_customer_id......................... [PASS in 1.32s]
2020-09-09 10:14:50.778177 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2020-09-09 10:14:50.778177 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-09-09 10:14:50.778177 (Thread-1): 12:14:50 | 7 of 7 START test unique_stg_orders_order_id......................... [RUN]
2020-09-09 10:14:50.778177 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-09-09 10:14:50.778177 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-09-09 10:14:50.781178 (Thread-1): unclosed <socket.socket fd=2744, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 52081), raddr=('216.58.207.42', 443)>
2020-09-09 10:14:50.781178 (Thread-1): unclosed <socket.socket fd=2756, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 52082), raddr=('216.58.208.42', 443)>
2020-09-09 10:14:50.789172 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-09-09 10:14:50.791172 (Thread-1): finished collecting timing info
2020-09-09 10:14:50.792172 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 10:14:50.793173 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from (

    select
        order_id

    from `dbttutorial-289007`.`dbt_jonathan`.`stg_orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors



2020-09-09 10:14:52.534396 (Thread-1): finished collecting timing info
2020-09-09 10:14:52.535410 (Thread-1): 12:14:52 | 7 of 7 PASS unique_stg_orders_order_id............................... [PASS in 1.76s]
2020-09-09 10:14:52.536392 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-09-09 10:14:52.537391 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 10:14:52.538398 (MainThread): 12:14:52 | 
2020-09-09 10:14:52.538398 (MainThread): 12:14:52 | Finished running 7 tests in 12.78s.
2020-09-09 10:14:52.538398 (MainThread): Connection 'master' was properly closed.
2020-09-09 10:14:52.538398 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 10:14:52.539399 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id' was properly closed.
2020-09-09 10:14:52.556395 (MainThread): 
2020-09-09 10:14:52.557587 (MainThread): Completed with 1 error and 0 warnings:
2020-09-09 10:14:52.563404 (MainThread): 
2020-09-09 10:14:52.565404 (MainThread): Failure in test accepted_values_stg_orders_status__placed (models\schema.yml)
2020-09-09 10:14:52.565404 (MainThread):   Got 4 results, expected 0.
2020-09-09 10:14:52.566303 (MainThread): 
2020-09-09 10:14:52.566303 (MainThread):   compiled SQL at target\compiled\jaffle_shop\models\schema.yml\schema_test\accepted_values_stg_orders_status__placed.sql
2020-09-09 10:14:52.567293 (MainThread): 
Done. PASS=6 WARN=0 ERROR=1 SKIP=0 TOTAL=7
2020-09-09 10:14:52.567293 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0D899A60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0DA63DC0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001FF0DA63A30>]}
2020-09-09 10:14:52.568294 (MainThread): Flushing usage events
2020-09-09 10:19:52.260388 (MainThread): Running with dbt=0.18.0
2020-09-09 10:19:52.292290 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 10:19:53.274984 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.test.TestTask'>, data=False, debug=False, defer=None, exclude=None, fail_fast=False, log_cache_events=False, log_format='default', models=['stg_orders'], partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='test', schema=False, selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='test', write_json=True)
2020-09-09 10:19:53.274984 (MainThread): Tracking: tracking
2020-09-09 10:19:53.275985 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B76F9BE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B8A19820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B8A19C40>]}
2020-09-09 10:19:53.296586 (MainThread): Partial parsing not enabled
2020-09-09 10:19:53.297581 (MainThread): Parsing macros\adapters.sql
2020-09-09 10:19:53.315701 (MainThread): Parsing macros\catalog.sql
2020-09-09 10:19:53.321533 (MainThread): Parsing macros\etc.sql
2020-09-09 10:19:53.323541 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 10:19:53.328558 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 10:19:53.342009 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 10:19:53.344494 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 10:19:53.346495 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 10:19:53.357521 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 10:19:53.362337 (MainThread): Parsing macros\core.sql
2020-09-09 10:19:53.366222 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 10:19:53.402259 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 10:19:53.411227 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 10:19:53.412234 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 10:19:53.415235 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 10:19:53.417220 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 10:19:53.420249 (MainThread): Parsing macros\etc\query.sql
2020-09-09 10:19:53.422259 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 10:19:53.431278 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 10:19:53.444306 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 10:19:53.448309 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 10:19:53.456298 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 10:19:53.475246 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 10:19:53.499329 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 10:19:53.501315 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 10:19:53.518540 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 10:19:53.526718 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 10:19:53.532733 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 10:19:53.539113 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 10:19:53.541990 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 10:19:53.544990 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 10:19:53.545991 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 10:19:53.554329 (MainThread): Partial parsing not enabled
2020-09-09 10:19:53.592295 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 10:19:53.612343 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 10:19:53.622314 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-09-09 10:19:53.892969 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 10:19:53.893985 (MainThread): 
2020-09-09 10:19:53.895969 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 10:19:53.910279 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 10:19:53.910279 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 10:19:53.911279 (ThreadPoolExecutor-1_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 10:19:54.242723 (MainThread): 12:19:54 | Concurrency: 1 threads (target='dev')
2020-09-09 10:19:54.242723 (MainThread): 12:19:54 | 
2020-09-09 10:19:54.250240 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-09-09 10:19:54.250240 (Thread-1): 12:19:54 | 1 of 3 START test accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [RUN]
2020-09-09 10:19:54.251225 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2020-09-09 10:19:54.251225 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-09-09 10:19:54.273231 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2020-09-09 10:19:54.274232 (Thread-1): finished collecting timing info
2020-09-09 10:19:54.275233 (Thread-1): Opening a new connection, currently in state init
2020-09-09 10:19:54.276230 (Thread-1): On test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"} */

    
    




with all_values as (

    select distinct
        status as value_field

    from `dbttutorial-289007`.`dbt_jonathan`.`stg_orders`

),

validation_errors as (

    select
        value_field

    from all_values
    where value_field not in (
        'placed','shipped','completed','return_pending','returned'
    )
)

select count(*) as validation_errors
from validation_errors



2020-09-09 10:19:56.258870 (Thread-1): finished collecting timing info
2020-09-09 10:19:56.258870 (Thread-1): 12:19:56 | 1 of 3 PASS accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned [PASS in 2.01s]
2020-09-09 10:19:56.259936 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-09-09 10:19:56.259936 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-09-09 10:19:56.259936 (Thread-1): 12:19:56 | 2 of 3 START test not_null_stg_orders_order_id....................... [RUN]
2020-09-09 10:19:56.260930 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-09-09 10:19:56.260930 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-09-09 10:19:56.262938 (Thread-1): unclosed <socket.socket fd=2488, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 52145), raddr=('172.217.16.170', 443)>
2020-09-09 10:19:56.263939 (Thread-1): unclosed <socket.socket fd=2640, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 52146), raddr=('216.58.208.42', 443)>
2020-09-09 10:19:56.275525 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-09-09 10:19:56.276518 (Thread-1): finished collecting timing info
2020-09-09 10:19:56.276518 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 10:19:56.277526 (Thread-1): On test.jaffle_shop.not_null_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.not_null_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from `dbttutorial-289007`.`dbt_jonathan`.`stg_orders`
where order_id is null



2020-09-09 10:19:58.115360 (Thread-1): finished collecting timing info
2020-09-09 10:19:58.116348 (Thread-1): 12:19:58 | 2 of 3 PASS not_null_stg_orders_order_id............................. [PASS in 1.86s]
2020-09-09 10:19:58.117344 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-09-09 10:19:58.117344 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-09-09 10:19:58.117344 (Thread-1): 12:19:58 | 3 of 3 START test unique_stg_orders_order_id......................... [RUN]
2020-09-09 10:19:58.118141 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-09-09 10:19:58.118141 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-09-09 10:19:58.122103 (Thread-1): unclosed <socket.socket fd=2532, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 52147), raddr=('172.217.16.170', 443)>
2020-09-09 10:19:58.122103 (Thread-1): unclosed <socket.socket fd=1000, family=AddressFamily.AF_INET, type=SocketKind.SOCK_STREAM, proto=0, laddr=('137.226.79.133', 52148), raddr=('216.58.208.42', 443)>
2020-09-09 10:19:58.128111 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-09-09 10:19:58.129104 (Thread-1): finished collecting timing info
2020-09-09 10:19:58.129104 (Thread-1): Opening a new connection, currently in state closed
2020-09-09 10:19:58.130097 (Thread-1): On test.jaffle_shop.unique_stg_orders_order_id: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "node_id": "test.jaffle_shop.unique_stg_orders_order_id"} */

    
    



select count(*) as validation_errors
from (

    select
        order_id

    from `dbttutorial-289007`.`dbt_jonathan`.`stg_orders`
    where order_id is not null
    group by order_id
    having count(*) > 1

) validation_errors



2020-09-09 10:20:00.010269 (Thread-1): finished collecting timing info
2020-09-09 10:20:00.010269 (Thread-1): 12:20:00 | 3 of 3 PASS unique_stg_orders_order_id............................... [PASS in 1.89s]
2020-09-09 10:20:00.011273 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-09-09 10:20:00.012259 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 10:20:00.012259 (MainThread): 12:20:00 | 
2020-09-09 10:20:00.012259 (MainThread): 12:20:00 | Finished running 3 tests in 6.12s.
2020-09-09 10:20:00.013266 (MainThread): Connection 'master' was properly closed.
2020-09-09 10:20:00.013266 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 10:20:00.013266 (MainThread): Connection 'test.jaffle_shop.unique_stg_orders_order_id' was properly closed.
2020-09-09 10:20:00.022362 (MainThread): 
2020-09-09 10:20:00.023353 (MainThread): Completed successfully
2020-09-09 10:20:00.025360 (MainThread): 
Done. PASS=3 WARN=0 ERROR=0 SKIP=0 TOTAL=3
2020-09-09 10:20:00.027398 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B8C1D220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B8BAB4F0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x000001E2B8BABF10>]}
2020-09-09 10:20:00.027398 (MainThread): Flushing usage events
2020-09-09 10:25:20.561009 (MainThread): Running with dbt=0.18.0
2020-09-09 10:25:20.595120 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 10:25:21.624917 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-09-09 10:25:21.625917 (MainThread): Tracking: tracking
2020-09-09 10:25:21.625917 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CFDD9BC40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CFF0BB8E0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CFF0BBC10>]}
2020-09-09 10:25:21.647600 (MainThread): Partial parsing not enabled
2020-09-09 10:25:21.649601 (MainThread): Parsing macros\adapters.sql
2020-09-09 10:25:21.668370 (MainThread): Parsing macros\catalog.sql
2020-09-09 10:25:21.673356 (MainThread): Parsing macros\etc.sql
2020-09-09 10:25:21.675357 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 10:25:21.679864 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 10:25:21.693874 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 10:25:21.696865 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 10:25:21.698876 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 10:25:21.708888 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 10:25:21.713880 (MainThread): Parsing macros\core.sql
2020-09-09 10:25:21.718955 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 10:25:21.755891 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 10:25:21.764892 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 10:25:21.765892 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 10:25:21.767893 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 10:25:21.771894 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 10:25:21.773894 (MainThread): Parsing macros\etc\query.sql
2020-09-09 10:25:21.775894 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 10:25:21.784970 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 10:25:21.797983 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 10:25:21.799975 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 10:25:21.806977 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 10:25:21.825876 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 10:25:21.849883 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 10:25:21.852884 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 10:25:21.869888 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 10:25:21.876888 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 10:25:21.881763 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 10:25:21.889765 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 10:25:21.892766 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 10:25:21.894766 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 10:25:21.897836 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 10:25:21.905582 (MainThread): Partial parsing not enabled
2020-09-09 10:25:21.940206 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 10:25:21.960284 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 10:25:21.968859 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-09-09 10:25:22.182522 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CFF2FDEE0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CFF2DAEB0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000027CFF344CD0>]}
2020-09-09 10:25:22.183523 (MainThread): Flushing usage events
2020-09-09 10:25:22.642332 (MainThread): Connection 'model.jaffle_shop.stg_orders' was properly closed.
2020-09-09 10:25:22.642332 (MainThread): Encountered an error:
2020-09-09 10:25:22.643335 (MainThread): Compilation Error in model customers (models\customers.sql)
  Documentation for 'model.jaffle_shop.customers' depends on doc 'customer'  which was not found
2020-09-09 10:25:22.660669 (MainThread): Traceback (most recent call last):
  File "c:\programdata\anaconda3\lib\site-packages\dbt\main.py", line 124, in main
    results, succeeded = handle_and_check(args)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\main.py", line 202, in handle_and_check
    task, res = run_from_args(parsed)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\main.py", line 255, in run_from_args
    results = task.run()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\generate.py", line 213, in run
    compile_results = CompileTask.run(self)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 399, in run
    self._runtime_initialize()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 118, in _runtime_initialize
    super()._runtime_initialize()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 78, in _runtime_initialize
    self.load_manifest()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\task\runnable.py", line 65, in load_manifest
    self.manifest = get_full_manifest(self.config)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\perf_utils.py", line 28, in get_full_manifest
    return load_manifest(
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 678, in load_manifest
    return ManifestLoader.load_all(config, macro_manifest, macro_hook)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 350, in load_all
    manifest = loader.create_manifest()
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 326, in create_manifest
    self.process_manifest(manifest)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 299, in process_manifest
    process_docs(manifest, self.root_project)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 536, in process_docs
    _process_docs_for_node(ctx, node)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\parser\manifest.py", line 498, in _process_docs_for_node
    node.description = get_rendered(node.description, context)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 577, in get_rendered
    return render_template(template, ctx, node)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\clients\jinja.py", line 528, in render_template
    return template.render(ctx)
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\environment.py", line 1090, in render
    self.environment.handle_exception()
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\environment.py", line 832, in handle_exception
    reraise(*rewrite_traceback_stack(source=source))
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\_compat.py", line 28, in reraise
    raise value.with_traceback(tb)
  File "<template>", line 1, in top-level template code
  File "c:\programdata\anaconda3\lib\site-packages\jinja2\sandbox.py", line 462, in call
    return __context.call(__obj, *args, **kwargs)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\context\docs.py", line 68, in doc
    doc_target_not_found(self.node, doc_name, doc_package_name)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 487, in doc_target_not_found
    raise_compiler_error(msg, model)
  File "c:\programdata\anaconda3\lib\site-packages\dbt\exceptions.py", line 407, in raise_compiler_error
    raise CompilationException(msg, node)
dbt.exceptions.CompilationException: Compilation Error in model customers (models\customers.sql)
  Documentation for 'model.jaffle_shop.customers' depends on doc 'customer'  which was not found

2020-09-09 10:25:59.842778 (MainThread): Running with dbt=0.18.0
2020-09-09 10:25:59.866783 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 10:26:00.719980 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.generate.GenerateTask'>, compile=True, debug=False, defer=None, exclude=None, log_cache_events=False, log_format='default', models=None, partial_parse=None, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method='docs.generate', selector_name=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, threads=None, use_cache=True, use_colors=None, vars='{}', version_check=True, warn_error=False, which='generate', write_json=True)
2020-09-09 10:26:00.720981 (MainThread): Tracking: tracking
2020-09-09 10:26:00.720981 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219D80FBC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219D940A820>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219D940ABE0>]}
2020-09-09 10:26:00.740966 (MainThread): Partial parsing not enabled
2020-09-09 10:26:00.741973 (MainThread): Parsing macros\adapters.sql
2020-09-09 10:26:00.758989 (MainThread): Parsing macros\catalog.sql
2020-09-09 10:26:00.763990 (MainThread): Parsing macros\etc.sql
2020-09-09 10:26:00.765979 (MainThread): Parsing macros\materializations\copy.sql
2020-09-09 10:26:00.769991 (MainThread): Parsing macros\materializations\incremental.sql
2020-09-09 10:26:00.781982 (MainThread): Parsing macros\materializations\seed.sql
2020-09-09 10:26:00.784995 (MainThread): Parsing macros\materializations\snapshot.sql
2020-09-09 10:26:00.786983 (MainThread): Parsing macros\materializations\table.sql
2020-09-09 10:26:00.796998 (MainThread): Parsing macros\materializations\view.sql
2020-09-09 10:26:00.801999 (MainThread): Parsing macros\core.sql
2020-09-09 10:26:00.804999 (MainThread): Parsing macros\adapters\common.sql
2020-09-09 10:26:00.840007 (MainThread): Parsing macros\etc\datetime.sql
2020-09-09 10:26:00.848009 (MainThread): Parsing macros\etc\get_custom_alias.sql
2020-09-09 10:26:00.849990 (MainThread): Parsing macros\etc\get_custom_database.sql
2020-09-09 10:26:00.851998 (MainThread): Parsing macros\etc\get_custom_schema.sql
2020-09-09 10:26:00.853990 (MainThread): Parsing macros\etc\is_incremental.sql
2020-09-09 10:26:00.855991 (MainThread): Parsing macros\etc\query.sql
2020-09-09 10:26:00.857012 (MainThread): Parsing macros\materializations\helpers.sql
2020-09-09 10:26:00.865013 (MainThread): Parsing macros\materializations\common\merge.sql
2020-09-09 10:26:00.878016 (MainThread): Parsing macros\materializations\incremental\helpers.sql
2020-09-09 10:26:00.880004 (MainThread): Parsing macros\materializations\incremental\incremental.sql
2020-09-09 10:26:00.885999 (MainThread): Parsing macros\materializations\seed\seed.sql
2020-09-09 10:26:00.904003 (MainThread): Parsing macros\materializations\snapshot\snapshot.sql
2020-09-09 10:26:00.926008 (MainThread): Parsing macros\materializations\snapshot\snapshot_merge.sql
2020-09-09 10:26:00.928015 (MainThread): Parsing macros\materializations\snapshot\strategies.sql
2020-09-09 10:26:00.943030 (MainThread): Parsing macros\materializations\table\table.sql
2020-09-09 10:26:00.950012 (MainThread): Parsing macros\materializations\view\create_or_replace_view.sql
2020-09-09 10:26:00.955014 (MainThread): Parsing macros\materializations\view\view.sql
2020-09-09 10:26:00.961015 (MainThread): Parsing macros\schema_tests\accepted_values.sql
2020-09-09 10:26:00.964015 (MainThread): Parsing macros\schema_tests\not_null.sql
2020-09-09 10:26:00.966017 (MainThread): Parsing macros\schema_tests\relationships.sql
2020-09-09 10:26:00.968016 (MainThread): Parsing macros\schema_tests\unique.sql
2020-09-09 10:26:00.975019 (MainThread): Partial parsing not enabled
2020-09-09 10:26:01.008033 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 10:26:01.027049 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 10:26:01.035051 (MainThread): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-09-09 10:26:01.289635 (MainThread): Found 3 models, 7 tests, 0 snapshots, 0 analyses, 155 macros, 0 operations, 0 seed files, 0 sources
2020-09-09 10:26:01.291643 (MainThread): 
2020-09-09 10:26:01.292636 (MainThread): Acquiring new bigquery connection "master".
2020-09-09 10:26:01.302631 (ThreadPoolExecutor-0_0): Acquiring new bigquery connection "list_dbttutorial-289007_dbt_jonathan".
2020-09-09 10:26:01.303639 (ThreadPoolExecutor-0_0): Opening a new connection, currently in state init
2020-09-09 10:26:01.304639 (ThreadPoolExecutor-0_0): Client.dataset is deprecated and will be removed in a future version. Use a string like 'my_project.my_dataset' or a cloud.google.bigquery.DatasetReference object, instead.
2020-09-09 10:26:01.636338 (MainThread): 12:26:01 | Concurrency: 1 threads (target='dev')
2020-09-09 10:26:01.637338 (MainThread): 12:26:01 | 
2020-09-09 10:26:01.659348 (Thread-1): Began running node model.jaffle_shop.stg_customers
2020-09-09 10:26:01.659348 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_customers".
2020-09-09 10:26:01.659348 (Thread-1): Compiling model.jaffle_shop.stg_customers
2020-09-09 10:26:01.674364 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_customers"
2020-09-09 10:26:01.674364 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.675351 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.675351 (Thread-1): Finished running node model.jaffle_shop.stg_customers
2020-09-09 10:26:01.675351 (Thread-1): Began running node model.jaffle_shop.stg_orders
2020-09-09 10:26:01.675351 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.stg_orders".
2020-09-09 10:26:01.676359 (Thread-1): Compiling model.jaffle_shop.stg_orders
2020-09-09 10:26:01.681366 (Thread-1): Writing injected SQL for node "model.jaffle_shop.stg_orders"
2020-09-09 10:26:01.682355 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.682355 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.682355 (Thread-1): Finished running node model.jaffle_shop.stg_orders
2020-09-09 10:26:01.682355 (Thread-1): Began running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-09-09 10:26:01.682355 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_customers_customer_id".
2020-09-09 10:26:01.682355 (Thread-1): Compiling test.jaffle_shop.not_null_stg_customers_customer_id
2020-09-09 10:26:01.696370 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_customers_customer_id"
2020-09-09 10:26:01.697359 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.697359 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.697359 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_customers_customer_id
2020-09-09 10:26:01.697359 (Thread-1): Began running node test.jaffle_shop.unique_stg_customers_customer_id
2020-09-09 10:26:01.698359 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_customers_customer_id".
2020-09-09 10:26:01.698359 (Thread-1): Compiling test.jaffle_shop.unique_stg_customers_customer_id
2020-09-09 10:26:01.705364 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_customers_customer_id"
2020-09-09 10:26:01.706361 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.706361 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.706361 (Thread-1): Finished running node test.jaffle_shop.unique_stg_customers_customer_id
2020-09-09 10:26:01.706361 (Thread-1): Began running node model.jaffle_shop.customers
2020-09-09 10:26:01.706361 (Thread-1): Acquiring new bigquery connection "model.jaffle_shop.customers".
2020-09-09 10:26:01.707361 (Thread-1): Compiling model.jaffle_shop.customers
2020-09-09 10:26:01.714366 (Thread-1): Writing injected SQL for node "model.jaffle_shop.customers"
2020-09-09 10:26:01.715374 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.715374 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.716363 (Thread-1): Finished running node model.jaffle_shop.customers
2020-09-09 10:26:01.716363 (Thread-1): Began running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-09-09 10:26:01.716363 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned".
2020-09-09 10:26:01.716363 (Thread-1): Compiling test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-09-09 10:26:01.725361 (Thread-1): Writing injected SQL for node "test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned"
2020-09-09 10:26:01.726364 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.726364 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.726364 (Thread-1): Finished running node test.jaffle_shop.accepted_values_stg_orders_status__placed__shipped__completed__return_pending__returned
2020-09-09 10:26:01.726364 (Thread-1): Began running node test.jaffle_shop.not_null_stg_orders_order_id
2020-09-09 10:26:01.727362 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_stg_orders_order_id".
2020-09-09 10:26:01.727362 (Thread-1): Compiling test.jaffle_shop.not_null_stg_orders_order_id
2020-09-09 10:26:01.735372 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_stg_orders_order_id"
2020-09-09 10:26:01.736365 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.736365 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.736365 (Thread-1): Finished running node test.jaffle_shop.not_null_stg_orders_order_id
2020-09-09 10:26:01.736365 (Thread-1): Began running node test.jaffle_shop.unique_stg_orders_order_id
2020-09-09 10:26:01.737365 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_stg_orders_order_id".
2020-09-09 10:26:01.737365 (Thread-1): Compiling test.jaffle_shop.unique_stg_orders_order_id
2020-09-09 10:26:01.744367 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_stg_orders_order_id"
2020-09-09 10:26:01.745375 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.746367 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.746367 (Thread-1): Finished running node test.jaffle_shop.unique_stg_orders_order_id
2020-09-09 10:26:01.746367 (Thread-1): Began running node test.jaffle_shop.not_null_customers_customer_id
2020-09-09 10:26:01.747367 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.not_null_customers_customer_id".
2020-09-09 10:26:01.747367 (Thread-1): Compiling test.jaffle_shop.not_null_customers_customer_id
2020-09-09 10:26:01.755383 (Thread-1): Writing injected SQL for node "test.jaffle_shop.not_null_customers_customer_id"
2020-09-09 10:26:01.755383 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.756376 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.756376 (Thread-1): Finished running node test.jaffle_shop.not_null_customers_customer_id
2020-09-09 10:26:01.756376 (Thread-1): Began running node test.jaffle_shop.unique_customers_customer_id
2020-09-09 10:26:01.756376 (Thread-1): Acquiring new bigquery connection "test.jaffle_shop.unique_customers_customer_id".
2020-09-09 10:26:01.756376 (Thread-1): Compiling test.jaffle_shop.unique_customers_customer_id
2020-09-09 10:26:01.764370 (Thread-1): Writing injected SQL for node "test.jaffle_shop.unique_customers_customer_id"
2020-09-09 10:26:01.765379 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.765379 (Thread-1): finished collecting timing info
2020-09-09 10:26:01.765379 (Thread-1): Finished running node test.jaffle_shop.unique_customers_customer_id
2020-09-09 10:26:01.766371 (MainThread): Connection 'master' was properly closed.
2020-09-09 10:26:01.767371 (MainThread): Connection 'list_dbttutorial-289007_dbt_jonathan' was properly closed.
2020-09-09 10:26:01.767371 (MainThread): Connection 'test.jaffle_shop.unique_customers_customer_id' was properly closed.
2020-09-09 10:26:01.790396 (MainThread): 12:26:01 | Done.
2020-09-09 10:26:01.796380 (MainThread): Acquiring new bigquery connection "generate_catalog".
2020-09-09 10:26:01.796380 (MainThread): 12:26:01 | Building catalog
2020-09-09 10:26:01.810380 (MainThread): Opening a new connection, currently in state init
2020-09-09 10:26:02.108185 (ThreadPoolExecutor-1_0): Acquiring new bigquery connection "dbttutorial-289007.information_schema".
2020-09-09 10:26:02.121180 (ThreadPoolExecutor-1_0): Opening a new connection, currently in state init
2020-09-09 10:26:02.121180 (ThreadPoolExecutor-1_0): On dbttutorial-289007.information_schema: /* {"app": "dbt", "dbt_version": "0.18.0", "profile_name": "jaffle_shop", "target_name": "dev", "connection_name": "dbttutorial-289007.information_schema"} */

    with tables as (
        select
            project_id as table_database,
            dataset_id as table_schema,
            table_id as original_table_name,

            concat(project_id, '.', dataset_id, '.', table_id) as relation_id,

            row_count,
            size_bytes as size_bytes,
            case
                when type = 1 then 'table'
                when type = 2 then 'view'
                else 'external'
            end as table_type,

            REGEXP_CONTAINS(table_id, '^.+[0-9]{8}$') and coalesce(type, 0) = 1 as is_date_shard,
            REGEXP_EXTRACT(table_id, '^(.+)[0-9]{8}$') as shard_base_name,
            REGEXP_EXTRACT(table_id, '^.+([0-9]{8})$') as shard_name

        from `dbttutorial-289007`.`dbt_jonathan`.__TABLES__
        where (upper(dataset_id) = upper('dbt_jonathan'))
    ),

    extracted as (

        select *,
            case
                when is_date_shard then shard_base_name
                else original_table_name
            end as table_name

        from tables

    ),

    unsharded_tables as (

        select
            table_database,
            table_schema,
            table_name,
            coalesce(table_type, 'external') as table_type,
            is_date_shard,

            struct(
                min(shard_name) as shard_min,
                max(shard_name) as shard_max,
                count(*) as shard_count
            ) as table_shards,

            sum(size_bytes) as size_bytes,
            sum(row_count) as row_count,

            max(relation_id) as relation_id

        from extracted
        group by 1,2,3,4,5

    ),

    info_schema_columns as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            table_catalog as table_database,
            table_schema,
            table_name,

            -- use the "real" column name from the paths query below
            column_name as base_column_name,
            ordinal_position as column_index,

            is_partitioning_column,
            clustering_ordinal_position

        from `dbttutorial-289007`.`dbt_jonathan`.INFORMATION_SCHEMA.COLUMNS
        where ordinal_position is not null

    ),

    info_schema_column_paths as (

        select
            concat(table_catalog, '.', table_schema, '.', table_name) as relation_id,
            field_path as column_name,
            data_type as column_type,
            column_name as base_column_name,
            description as column_comment

        from `dbttutorial-289007`.`dbt_jonathan`.INFORMATION_SCHEMA.COLUMN_FIELD_PATHS

    ),

    columns as (

        select * except (base_column_name)
        from info_schema_columns
        join info_schema_column_paths using (relation_id, base_column_name)

    ),

    column_stats as (

        select
            table_database,
            table_schema,
            table_name,
            max(relation_id) as relation_id,
            max(case when is_partitioning_column = 'YES' then 1 else 0 end) = 1 as is_partitioned,
            max(case when is_partitioning_column = 'YES' then column_name else null end) as partition_column,
            max(case when clustering_ordinal_position is not null then 1 else 0 end) = 1 as is_clustered,
            array_to_string(
                array_agg(
                    case
                        when clustering_ordinal_position is not null then column_name
                        else null
                    end ignore nulls
                    order by clustering_ordinal_position
                ), ', '
            ) as clustering_columns

        from columns
        group by 1,2,3

    )

    select
        unsharded_tables.table_database,
        unsharded_tables.table_schema,
        case
            when is_date_shard then concat(unsharded_tables.table_name, '*')
            else unsharded_tables.table_name
        end as table_name,
        unsharded_tables.table_type,

        -- coalesce name and type for External tables - these columns are not
        -- present in the COLUMN_FIELD_PATHS resultset
        coalesce(columns.column_name, '<unknown>') as column_name,
        -- invent a row number to account for nested fields -- BQ does
        -- not treat these nested properties as independent fields
        row_number() over (
            partition by relation_id
            order by columns.column_index, columns.column_name
        ) as column_index,
        coalesce(columns.column_type, '<unknown>') as column_type,
        columns.column_comment,

        'Shard count' as `stats__date_shards__label`,
        table_shards.shard_count as `stats__date_shards__value`,
        'The number of date shards in this table' as `stats__date_shards__description`,
        is_date_shard as `stats__date_shards__include`,

        'Shard (min)' as `stats__date_shard_min__label`,
        table_shards.shard_min as `stats__date_shard_min__value`,
        'The first date shard in this table' as `stats__date_shard_min__description`,
        is_date_shard as `stats__date_shard_min__include`,

        'Shard (max)' as `stats__date_shard_max__label`,
        table_shards.shard_max as `stats__date_shard_max__value`,
        'The last date shard in this table' as `stats__date_shard_max__description`,
        is_date_shard as `stats__date_shard_max__include`,

        '# Rows' as `stats__num_rows__label`,
        row_count as `stats__num_rows__value`,
        'Approximate count of rows in this table' as `stats__num_rows__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_rows__include`,

        'Approximate Size' as `stats__num_bytes__label`,
        size_bytes as `stats__num_bytes__value`,
        'Approximate size of table as reported by BigQuery' as `stats__num_bytes__description`,
        (unsharded_tables.table_type = 'table') as `stats__num_bytes__include`,

        'Partitioned By' as `stats__partitioning_type__label`,
        partition_column as `stats__partitioning_type__value`,
        'The partitioning column for this table' as `stats__partitioning_type__description`,
        is_partitioned as `stats__partitioning_type__include`,

        'Clustered By' as `stats__clustering_fields__label`,
        clustering_columns as `stats__clustering_fields__value`,
        'The clustering columns for this table' as `stats__clustering_fields__description`,
        is_clustered as `stats__clustering_fields__include`

    -- join using relation_id (an actual relation, not a shard prefix) to make
    -- sure that column metadata is picked up through the join. This will only
    -- return the column information for the "max" table in a date-sharded table set
    from unsharded_tables
    left join columns using (relation_id)
    left join column_stats using (relation_id)
  
2020-09-09 10:26:05.592178 (MainThread): 12:26:05 | Catalog written to C:\Users\Jonathan Jansen\Documents\dbt\dbt-tutorial\target\catalog.json
2020-09-09 10:26:05.593172 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219D80FBC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219D97CB940>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x00000219D97CB820>]}
2020-09-09 10:26:05.593172 (MainThread): Flushing usage events
2020-09-09 10:26:06.020894 (MainThread): Connection 'generate_catalog' was properly closed.
2020-09-09 10:26:06.021891 (MainThread): Connection 'dbttutorial-289007.information_schema' was properly closed.
2020-09-09 10:26:32.100359 (MainThread): Running with dbt=0.18.0
2020-09-09 10:26:32.131365 (MainThread): the imp module is deprecated in favour of importlib; see the module's documentation for alternative uses
2020-09-09 10:26:33.165746 (MainThread): running dbt with arguments Namespace(cls=<class 'dbt.task.serve.ServeTask'>, debug=False, defer=None, log_cache_events=False, log_format='default', open_browser=True, partial_parse=None, port=8080, profile=None, profiles_dir='C:\\Users\\Jonathan Jansen\\.dbt', project_dir=None, record_timing_info=None, rpc_method=None, single_threaded=False, state=None, strict=False, target=None, test_new_parser=False, use_cache=True, use_colors=None, vars='{}', warn_error=False, which='serve', write_json=True)
2020-09-09 10:26:33.165746 (MainThread): Tracking: tracking
2020-09-09 10:26:33.165746 (MainThread): Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CCAFABC10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CCC2C9790>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x0000026CCC2C9BB0>]}
2020-09-09 10:26:33.169713 (MainThread): Serving docs at 0.0.0.0:8080
2020-09-09 10:26:33.170712 (MainThread): To access from your browser, navigate to:  http://localhost:8080
2020-09-09 10:26:33.173711 (MainThread): Press Ctrl+C to exit.


